"use strict";(self.webpackChunkwiki=self.webpackChunkwiki||[]).push([[1297],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return d}});var s=n(67294);function m(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){m(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){if(null==e)return{};var n,s,m=function(e,t){if(null==e)return{};var n,s,m={},l=Object.keys(e);for(s=0;s<l.length;s++)n=l[s],t.indexOf(n)>=0||(m[n]=e[n]);return m}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(s=0;s<l.length;s++)n=l[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(m[n]=e[n])}return m}var r=s.createContext({}),i=function(e){var t=s.useContext(r),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},u=function(e){var t=i(e.components);return s.createElement(r.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return s.createElement(s.Fragment,{},t)}},o=s.forwardRef((function(e,t){var n=e.components,m=e.mdxType,l=e.originalType,r=e.parentName,u=p(e,["components","mdxType","originalType","parentName"]),o=i(n),d=m,g=o["".concat(r,".").concat(d)]||o[d]||c[d]||l;return n?s.createElement(g,a(a({ref:t},u),{},{components:n})):s.createElement(g,a({ref:t},u))}));function d(e,t){var n=arguments,m=t&&t.mdxType;if("string"==typeof e||m){var l=n.length,a=new Array(l);a[0]=o;var p={};for(var r in t)hasOwnProperty.call(t,r)&&(p[r]=t[r]);p.originalType=e,p.mdxType="string"==typeof e?e:m,a[1]=p;for(var i=2;i<l;i++)a[i]=n[i];return s.createElement.apply(null,a)}return s.createElement.apply(null,n)}o.displayName="MDXCreateElement"},86476:function(e,t,n){n.r(t),n.d(t,{frontMatter:function(){return p},contentTitle:function(){return r},metadata:function(){return i},toc:function(){return u},default:function(){return o}});var s=n(87462),m=n(63366),l=(n(67294),n(3905)),a=["components"],p={id:"D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b",title:"D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b","typora-root-url":"../"},r=void 0,i={unversionedId:"Server/D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b",id:"Server/D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b",isDocsHomePage:!1,title:"D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b",description:"\u591a\u8fdb\u7a0b\u7f16\u7a0b",source:"@site/docs/8.Server/D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b.md",sourceDirName:"8.Server",slug:"/Server/D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b",permalink:"/Server/D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b",editUrl:"https://github.com/worst0/wiki_note/edit/main/docs/8.Server/D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b.md",version:"current",lastUpdatedAt:1633869865,formattedLastUpdatedAt:"10/10/2021",frontMatter:{id:"D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b",title:"D1.\u591a\u8fdb\u7a0b\u7f16\u7a0b","typora-root-url":"../"},sidebar:"Document\ud83d\udcbb",previous:{title:"C9.\u5b9e\u73b0",permalink:"/Server/C9.\u5b9e\u73b0"},next:{title:"D2.\u8fdb\u7a0b",permalink:"/Server/D2.\u8fdb\u7a0b"}},u=[{value:"\u591a\u8fdb\u7a0b\u7f16\u7a0b",id:"\u591a\u8fdb\u7a0b\u7f16\u7a0b",children:[{value:"fork\u7cfb\u7edf\u8c03\u7528",id:"fork\u7cfb\u7edf\u8c03\u7528",children:[]},{value:"exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528",id:"exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528",children:[]},{value:"\u5904\u7406\u50f5\u5c38\u8fdb\u7a0b",id:"\u5904\u7406\u50f5\u5c38\u8fdb\u7a0b",children:[]},{value:"\u7ba1\u9053",id:"\u7ba1\u9053",children:[]},{value:"\u4fe1\u53f7\u91cf\uff08Semaphore\uff09",id:"\u4fe1\u53f7\u91cfsemaphore",children:[]},{value:"\u5171\u4eab\u5185\u5b58",id:"\u5171\u4eab\u5185\u5b58",children:[]},{value:"\u6d88\u606f\u961f\u5217",id:"\u6d88\u606f\u961f\u5217",children:[]},{value:"IPC\u547d\u4ee4",id:"ipc\u547d\u4ee4",children:[]},{value:"\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26",id:"\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26",children:[]}]}],c={toc:u};function o(e){var t=e.components,p=(0,m.Z)(e,a);return(0,l.kt)("wrapper",(0,s.Z)({},c,p,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"\u591a\u8fdb\u7a0b\u7f16\u7a0b"},"\u591a\u8fdb\u7a0b\u7f16\u7a0b"),(0,l.kt)("p",null,"\u8fdb\u7a0b\u662fLinux\u64cd\u4f5c\u7cfb\u7edf\u73af\u5883\u7684\u57fa\u7840\uff0c\u5b83\u63a7\u5236\u7740\u7cfb\u7edf\u4e0a\u51e0\u4e4e\u6240\u6709\u7684\u6d3b\u52a8\u3002"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u590d\u5236\u8fdb\u7a0b\u6620\u50cf\u7684fork\u7cfb\u7edf\u8c03\u7528\u548c\u66ff\u6362\u8fdb\u7a0b\u6620\u50cf\u7684exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u50f5\u5c38\u8fdb\u7a0b\u4ee5\u53ca\u5982\u4f55\u907f\u514d\u50f5\u5c38\u8fdb\u7a0b\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u8fdb\u7a0b\u95f4\u901a\u4fe1\uff08Inter-Process Communication\uff0cIPC\uff09\u6700\u7b80\u5355\u7684\u65b9\u5f0f\uff1a\u7ba1\u9053\u3002"),(0,l.kt)("li",{parentName:"ul"},"3\u79cdSystem V\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\uff1a\u4fe1\u53f7\u91cf\u3001\u6d88\u606f\u961f\u5217\u548c\u5171\u4eab\u5185\u5b58\u3002\u5b83\u4eec\u90fd\u662f\u7531AT\uff06T System V2\u7248\u672c\u7684UNIX\u5f15\u5165\u7684\uff0c\u6240\u4ee5\u7edf\u79f0\u4e3aSystem V IPC\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u901a\u7528\u65b9\u6cd5\uff1a\u901a\u8fc7UNIX\u672c\u5730\u57dfsocket\u4f20\u9012\u7279\u6b8a\u7684\u300c\u8f85\u52a9\u6570\u636e\u300d")),(0,l.kt)("h3",{id:"fork\u7cfb\u7edf\u8c03\u7528"},"fork\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <sys/types.h>\n#include <unistd.h>\npid_t fork(void);\n")),(0,l.kt)("p",null,"\u8be5\u51fd\u6570\u7684\u6bcf\u6b21\u8c03\u7528\u90fd\u8fd4\u56de\u4e24\u6b21\uff0c\u5728\u7236\u8fdb\u7a0b\u4e2d\u8fd4\u56de\u7684\u662f\u5b50\u8fdb\u7a0b\u7684PID\uff0c\u5728\u5b50\u8fdb\u7a0b\u4e2d\u5219\u8fd4\u56de0\u3002"),(0,l.kt)("p",null,"fork\u8c03\u7528\u5931\u8d25\u65f6\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("p",null,"fork\u51fd\u6570\u590d\u5236\u5f53\u524d\u8fdb\u7a0b\uff0c\u5728\u5185\u6838\u8fdb\u7a0b\u8868\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u8fdb\u7a0b\u8868\u9879\u3002\u65b0\u7684\u8fdb\u7a0b\u8868\u9879\u6709\u5f88\u591a\u5c5e\u6027\u548c\u539f\u8fdb\u7a0b\u76f8\u540c\uff0c\u6bd4\u5982\u5806\u6307\u9488\u3001\u6808\u6307\u9488\u548c\u6807\u5fd7\u5bc4\u5b58\u5668\u7684\u503c\u3002\u4f46\u4e5f\u6709\u8bb8\u591a\u5c5e\u6027\u88ab\u8d4b\u4e88\u4e86\u65b0\u7684\u503c\uff0c\u6bd4\u5982\u8be5\u8fdb\u7a0b\u7684PPID\u88ab\u8bbe\u7f6e\u6210\u539f\u8fdb\u7a0b\u7684PID\uff0c\u4fe1\u53f7\u4f4d\u56fe\u88ab\u6e05\u9664\uff08\u539f\u8fdb\u7a0b\u8bbe\u7f6e\u7684\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u4e0d\u518d\u5bf9\u65b0\u8fdb\u7a0b\u8d77\u4f5c\u7528\uff09\u3002"),(0,l.kt)("p",null,"\u5b50\u8fdb\u7a0b\u7684\u4ee3\u7801\u4e0e\u7236\u8fdb\u7a0b\u5b8c\u5168\u76f8\u540c\uff0c\u540c\u65f6\u5b83\u8fd8\u4f1a\u590d\u5236\u7236\u8fdb\u7a0b\u7684\u6570\u636e\uff08\u5806\u6570\u636e\u3001\u6808\u6570\u636e\u548c\u9759\u6001\u6570\u636e\uff09\u3002\u6570\u636e\u7684\u590d\u5236\u91c7\u7528\u7684\u662f\u6240\u8c13\u7684\u5199\u65f6\u590d\u5236\uff08copy on writte\uff09\uff0c\u5373\u53ea\u6709\u5728\u4efb\u4e00\u8fdb\u7a0b\uff08\u7236\u8fdb\u7a0b\u6216\u5b50\u8fdb\u7a0b\uff09\u5bf9\u6570\u636e\u6267\u884c\u4e86\u5199\u64cd\u4f5c\u65f6\uff0c\u590d\u5236\u624d\u4f1a\u53d1\u751f\uff08\u5148\u662f\u7f3a\u9875\u4e2d\u65ad\uff0c\u7136\u540e\u64cd\u4f5c\u7cfb\u7edf\u7ed9\u5b50\u8fdb\u7a0b\u5206\u914d\u5185\u5b58\u5e76\u590d\u5236\u7236\u8fdb\u7a0b\u7684\u6570\u636e\uff09\u3002\u5373\u4fbf\u5982\u6b64\uff0c\u5982\u679c\u6211\u4eec\u5728\u7a0b\u5e8f\u4e2d\u5206\u914d\u4e86\u5927\u91cf\u5185\u5b58\uff0c\u90a3\u4e48\u4f7f\u7528fork\u65f6\u4e5f\u5e94\u5f53\u5341\u5206\u8c28\u614e\uff0c\u5c3d\u91cf\u907f\u514d\u6ca1\u5fc5\u8981\u7684\u5185\u5b58\u5206\u914d\u548c\u6570\u636e\u590d\u5236\u3002"),(0,l.kt)("p",null,"\u6b64\u5916\uff0c\u521b\u5efa\u5b50\u8fdb\u7a0b\u540e\uff0c\u7236\u8fdb\u7a0b\u4e2d\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u9ed8\u8ba4\u5728\u5b50\u8fdb\u7a0b\u4e2d\u4e5f\u662f\u6253\u5f00\u7684\uff0c\u4e14\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u5f15\u7528\u8ba1\u6570\u52a01\u3002\u4e0d\u4ec5\u5982\u6b64\uff0c\u7236\u8fdb\u7a0b\u7684\u7528\u6237\u6839\u76ee\u5f55\u3001\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u7b49\u53d8\u91cf\u7684\u5f15\u7528\u8ba1\u6570\u5747\u4f1a\u52a01\u3002"),(0,l.kt)("h3",{id:"exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528"},"exec\u7cfb\u5217\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <unistd.h>\nextern char **environ;\nint execl(const char *pathname, const char *arg, ... /* (char  *) NULL */);\nint execlp(const char *file, const char *arg, ... /* (char  *) NULL */);\nint execle(const char *pathname, const char *arg, ... /*, (char *) NULL, char *const envp[] */);\nint execv(const char *pathname, char *const argv[]);\nint execvp(const char *file, char *const argv[]);\nint execvpe(const char *file, char *const argv[], char *const envp[]);\n\n")),(0,l.kt)("p",null,"path\u53c2\u6570\u6307\u5b9a\u53ef\u6267\u884c\u6587\u4ef6\u7684\u5b8c\u6574\u8def\u5f84\uff0cfile\u53c2\u6570\u53ef\u4ee5\u63a5\u53d7\u6587\u4ef6\u540d\uff0c\u8be5\u6587\u4ef6\u7684\u5177\u4f53\u4f4d\u7f6e\u5219\u5728\u73af\u5883\u53d8\u91cfPATH\u4e2d\u641c\u5bfb\u3002arg\u63a5\u53d7\u53ef\u53d8\u53c2\u6570\uff0cargv\u5219\u63a5\u53d7\u53c2\u6570\u6570\u7ec4\uff0c\u5b83\u4eec\u90fd\u4f1a\u88ab\u4f20\u9012\u7ed9\u65b0\u7a0b\u5e8f\uff08path\u6216file\u6307\u5b9a\u7684\u7a0b\u5e8f\uff09\u7684main\u51fd\u6570\u3002envp\u53c2\u6570\u7528\u4e8e\u8bbe\u7f6e\u65b0\u7a0b\u5e8f\u7684\u73af\u5883\u53d8\u91cf\u3002\u5982\u679c\u672a\u8bbe\u7f6e\u5b83\uff0c\u5219\u65b0\u7a0b\u5e8f\u5c06\u4f7f\u7528\u7531\u5168\u5c40\u53d8\u91cfenviron\u6307\u5b9a\u7684\u73af\u5883\u53d8\u91cf\u3002"),(0,l.kt)("p",null,"\u4e00\u822c\u60c5\u51b5\u4e0b\uff0cexec\u51fd\u6570\u662f\u4e0d\u8fd4\u56de\u7684\uff0c\u9664\u975e\u51fa\u9519\u3002\u5b83\u51fa\u9519\u65f6\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u3002\u5982\u679c\u6ca1\u51fa\u9519\uff0c\u5219\u539f\u7a0b\u5e8f\u4e2dexec\u8c03\u7528\u4e4b\u540e\u7684\u4ee3\u7801\u90fd\u4e0d\u4f1a\u6267\u884c\uff0c\u56e0\u4e3a\u6b64\u65f6\u539f\u7a0b\u5e8f\u5df2\u7ecf\u88abexec\u7684\u53c2\u6570\u6307\u5b9a\u7684\u7a0b\u5e8f\u5b8c\u5168\u66ff\u6362\uff08\u5305\u62ec\u4ee3\u7801\u548c\u6570\u636e\uff09\u3002"),(0,l.kt)("p",null,"exec\u51fd\u6570\u4e0d\u4f1a\u5173\u95ed\u539f\u7a0b\u5e8f\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u9664\u975e\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u88ab\u8bbe\u7f6e\u4e86\u7c7b\u4f3cSOCK_CLOEXEC\u7684\u5c5e\u6027"),(0,l.kt)("h3",{id:"\u5904\u7406\u50f5\u5c38\u8fdb\u7a0b"},"\u5904\u7406\u50f5\u5c38\u8fdb\u7a0b"),(0,l.kt)("p",null,"\u5bf9\u4e8e\u591a\u8fdb\u7a0b\u7a0b\u5e8f\u800c\u8a00\uff0c\u7236\u8fdb\u7a0b\u4e00\u822c\u9700\u8981\u8ddf\u8e2a\u5b50\u8fdb\u7a0b\u7684\u9000\u51fa\u72b6\u6001\u3002\u56e0\u6b64\uff0c\u5f53\u5b50\u8fdb\u7a0b\u7ed3\u675f\u8fd0\u884c\u65f6\uff0c\u5185\u6838\u4e0d\u4f1a\u7acb\u5373\u91ca\u653e\u8be5\u8fdb\u7a0b\u7684\u8fdb\u7a0b\u8868\u8868\u9879\uff0c\u4ee5\u6ee1\u8db3\u7236\u8fdb\u7a0b\u540e\u7eed\u5bf9\u8be5\u5b50\u8fdb\u7a0b\u9000\u51fa\u4fe1\u606f\u7684\u67e5\u8be2\uff08\u5982\u679c\u7236\u8fdb\u7a0b\u8fd8\u5728\u8fd0\u884c\uff09\u3002\u5728\u5b50\u8fdb\u7a0b\u7ed3\u675f\u8fd0\u884c\u4e4b\u540e\uff0c\u7236\u8fdb\u7a0b\u8bfb\u53d6\u5176\u9000\u51fa\u72b6\u6001\u4e4b\u524d\uff0c\u6211\u4eec\u79f0\u8be5\u5b50\u8fdb\u7a0b\u5904\u4e8e\u50f5\u5c38\u6001\u3002\u53e6\u5916\u4e00\u79cd\u4f7f\u5b50\u8fdb\u7a0b\u8fdb\u5165\u50f5\u5c38\u6001\u7684\u60c5\u51b5\u662f\uff1a\u7236\u8fdb\u7a0b\u7ed3\u675f\u6216\u8005\u5f02\u5e38\u7ec8\u6b62\uff0c\u800c\u5b50\u8fdb\u7a0b\u7ee7\u7eed\u8fd0\u884c\u3002\u6b64\u65f6\u5b50\u8fdb\u7a0b\u7684PPID\u5c06\u88ab\u64cd\u4f5c\u7cfb\u7edf\u8bbe\u7f6e\u4e3a1\uff0c\u5373init\u8fdb\u7a0b\u3002init\u8fdb\u7a0b\u63a5\u7ba1\u4e86\u8be5\u5b50\u8fdb\u7a0b\uff0c\u5e76\u7b49\u5f85\u5b83\u7ed3\u675f\u3002\u5728\u7236\u8fdb\u7a0b\u9000\u51fa\u4e4b\u540e\uff0c\u5b50\u8fdb\u7a0b\u9000\u51fa\u4e4b\u524d\uff0c\u8be5\u5b50\u8fdb\u7a0b\u5904\u4e8e\u50f5\u5c38\u6001\u3002"),(0,l.kt)("p",null,"\u7531\u6b64\u53ef\u89c1\uff0c\u65e0\u8bba\u54ea\u79cd\u60c5\u51b5\uff0c\u5982\u679c\u7236\u8fdb\u7a0b\u6ca1\u6709\u6b63\u786e\u5730\u5904\u7406\u5b50\u8fdb\u7a0b\u7684\u8fd4\u56de\u4fe1\u606f\uff0c\u5b50\u8fdb\u7a0b\u90fd\u5c06\u505c\u7559\u5728\u50f5\u5c38\u6001\uff0c\u5e76\u5360\u636e\u7740\u5185\u6838\u8d44\u6e90\u3002\u8fd9\u662f\u7edd\u5bf9\u4e0d\u80fd\u5bb9\u8bb8\u7684\uff0c\u6bd5\u7adf\u5185\u6838\u8d44\u6e90\u6709\u9650\u3002\u4e0b\u9762\u8fd9\u5bf9\u51fd\u6570\u5728\u7236\u8fdb\u7a0b\u4e2d\u8c03\u7528\uff0c\u4ee5\u7b49\u5f85\u5b50\u8fdb\u7a0b\u7684\u7ed3\u675f\uff0c\u5e76\u83b7\u53d6\u5b50\u8fdb\u7a0b\u7684\u8fd4\u56de\u4fe1\u606f\uff0c\u4ece\u800c\u907f\u514d\u4e86\u50f5\u5c38\u8fdb\u7a0b\u7684\u4ea7\u751f\uff0c\u6216\u8005\u4f7f\u5b50\u8fdb\u7a0b\u7684\u50f5\u5c38\u6001\u7acb\u5373\u7ed3\u675f\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <sys/types.h>\n#include <sys/wait.h>\npid_t wait(int *wstatus);\npid_t waitpid(pid_t pid, int *wstatus, int options);\n")),(0,l.kt)("p",null,"wait\u51fd\u6570\u5c06\u963b\u585e\u8fdb\u7a0b\uff0c\u76f4\u5230\u8be5\u8fdb\u7a0b\u7684\u67d0\u4e2a\u5b50\u8fdb\u7a0b\u7ed3\u675f\u8fd0\u884c\u4e3a\u6b62\u3002\u5b83\u8fd4\u56de\u7ed3\u675f\u8fd0\u884c\u7684\u5b50\u8fdb\u7a0b\u7684PID\uff0c\u5e76\u5c06\u8be5\u5b50\u8fdb\u7a0b\u7684\u9000\u51fa\u72b6\u6001\u4fe1\u606f\u5b58\u50a8\u4e8estat_loc\u53c2\u6570\u6307\u5411\u7684\u5185\u5b58\u4e2d\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20210910153709109",src:n(38491).Z})),(0,l.kt)("p",null,"wait\u51fd\u6570\u7684\u963b\u585e\u7279\u6027\u663e\u7136\u4e0d\u662f\u670d\u52a1\u5668\u7a0b\u5e8f\u671f\u671b\u7684\uff0c\u800cwaitpid\u51fd\u6570\u89e3\u51b3\u4e86\u8fd9\u4e2a\u95ee\u9898\u3002waitpid\u53ea\u7b49\u5f85\u7531pid\u53c2\u6570\u6307\u5b9a\u7684\u5b50\u8fdb\u7a0b\u3002\u5982\u679cpid\u53d6\u503c\u4e3a-1\uff0c\u90a3\u4e48\u5b83\u5c31\u548cwait\u51fd\u6570\u76f8\u540c\uff0c\u5373\u7b49\u5f85\u4efb\u610f\u4e00\u4e2a\u5b50\u8fdb\u7a0b\u7ed3\u675f\u3002stat_loc\u53c2\u6570\u7684\u542b\u4e49\u548cwait\u51fd\u6570\u7684stat_loc\u53c2\u6570\u76f8\u540c\u3002options\u53c2\u6570\u53ef\u4ee5\u63a7\u5236waitpid\u51fd\u6570\u7684\u884c\u4e3a\u3002\u8be5\u53c2\u6570\u6700\u5e38\u7528\u7684\u53d6\u503c\u662fWNOHANG\u3002\u5f53options\u7684\u53d6\u503c\u662fWNOHANG\u65f6\uff0cwaitpid\u8c03\u7528\u5c06\u662f\u975e\u963b\u585e\u7684\uff1a\u5982\u679cpid\u6307\u5b9a\u7684\u76ee\u6807\u5b50\u8fdb\u7a0b\u8fd8\u6ca1\u6709\u7ed3\u675f\u6216\u610f\u5916\u7ec8\u6b62\uff0c\u5219waitpid\u7acb\u5373\u8fd4\u56de0\uff1b\u5982\u679c\u76ee\u6807\u5b50\u8fdb\u7a0b\u786e\u5b9e\u6b63\u5e38\u9000\u51fa\u4e86\uff0c\u5219waitpid\u8fd4\u56de\u8be5\u5b50\u8fdb\u7a0b\u7684PID\u3002waitpid\u8c03\u7528\u5931\u8d25\u65f6\u8fd4\u56de-1\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("p",null,"\u8981\u5728\u4e8b\u4ef6\u5df2\u7ecf\u53d1\u751f\u7684\u60c5\u51b5\u4e0b\u6267\u884c\u975e\u963b\u585e\u8c03\u7528\u624d\u80fd\u63d0\u9ad8\u7a0b\u5e8f\u7684\u6548\u7387\u3002\u5bf9waitpid\u51fd\u6570\u800c\u8a00\uff0c\u6211\u4eec\u6700\u597d\u5728\u67d0\u4e2a\u5b50\u8fdb\u7a0b\u9000\u51fa\u4e4b\u540e\u518d\u8c03\u7528\u5b83\u3002\u90a3\u4e48\u7236\u8fdb\u7a0b\u4ece\u4f55\u5f97\u77e5\u67d0\u4e2a\u5b50\u8fdb\u7a0b\u5df2\u7ecf\u9000\u51fa\u4e86\u5462\uff1f\u8fd9\u6b63\u662fSIGCHLD\u4fe1\u53f7\u7684\u7528\u9014\u3002\u5f53\u4e00\u4e2a\u8fdb\u7a0b\u7ed3\u675f\u65f6\uff0c\u5b83\u5c06\u7ed9\u5176\u7236\u8fdb\u7a0b\u53d1\u9001\u4e00\u4e2aSIGCHLD\u4fe1\u53f7\u3002\u56e0\u6b64\uff0c\u6211\u4eec\u53ef\u4ee5\u5728\u7236\u8fdb\u7a0b\u4e2d\u6355\u83b7SIGCHLD\u4fe1\u53f7\uff0c\u5e76\u5728\u4fe1\u53f7\u5904\u7406\u51fd\u6570\u4e2d\u8c03\u7528waitpid\u51fd\u6570\u4ee5\u201c\u5f7b\u5e95\u7ed3\u675f\u201d\u4e00\u4e2a\u5b50\u8fdb\u7a0b\uff0c"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"\nstatic void handle_child(int sig)\n{\n    pid_t pid;\n    int stat;\n    while((pid=waitpid(-1,\uff06stat,WNOHANG))\uff1e0)\n    {\n    /*\u5bf9\u7ed3\u675f\u7684\u5b50\u8fdb\u7a0b\u8fdb\u884c\u5584\u540e\u5904\u7406*/\n    }\n}\n")),(0,l.kt)("h3",{id:"\u7ba1\u9053"},"\u7ba1\u9053"),(0,l.kt)("p",null,"\u7ba1\u9053\u80fd\u5728\u7236\u3001\u5b50\u8fdb\u7a0b\u95f4\u4f20\u9012\u6570\u636e\uff0c\u5229\u7528\u7684\u662ffork\u8c03\u7528\u4e4b\u540e\u4e24\u4e2a\u7ba1\u9053\u6587\u4ef6\u63cf\u8ff0\u7b26\uff08fd","[0]","\u548cfd","[1]","\uff09\u90fd\u4fdd\u6301\u6253\u5f00\u3002\u4e00\u5bf9\u8fd9\u6837\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ea\u80fd\u4fdd\u8bc1\u7236\u3001\u5b50\u8fdb\u7a0b\u95f4\u4e00\u4e2a\u65b9\u5411\u7684\u6570\u636e\u4f20\u8f93\uff0c\u7236\u8fdb\u7a0b\u548c\u5b50\u8fdb\u7a0b\u5fc5\u987b\u6709\u4e00\u4e2a\u5173\u95edfd","[0]","\uff0c\u53e6\u4e00\u4e2a\u5173\u95edfd","[1]","\u3002\u6bd4\u5982\uff0c\u6211\u4eec\u8981\u4f7f\u7528\u7ba1\u9053\u5b9e\u73b0\u4ece\u7236\u8fdb\u7a0b\u5411\u5b50\u8fdb\u7a0b\u5199\u6570\u636e"),(0,l.kt)("u",null,"\u56fe\u300013-1\u3000\u7236\u8fdb\u7a0b\u901a\u8fc7\u7ba1\u9053\u5411\u5b50\u8fdb\u7a0b\u5199\u6570\u636e"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20210910154057147",src:n(7283).Z})),(0,l.kt)("p",null,"\u663e\u7136\uff0c\u5982\u679c\u8981\u5b9e\u73b0\u7236\u3001\u5b50\u8fdb\u7a0b\u4e4b\u95f4\u7684\u53cc\u5411\u6570\u636e\u4f20\u8f93\uff0c\u5c31\u5fc5\u987b\u4f7f\u7528\u4e24\u4e2a\u7ba1\u9053\u3002socket\u7f16\u7a0b\u63a5\u53e3\u63d0\u4f9b\u4e86\u4e00\u4e2a\u521b\u5efa\u5168\u53cc\u5de5\u7ba1\u9053\u7684\u7cfb\u7edf\u8c03\u7528\uff1asocketpair\u3002"),(0,l.kt)("p",null,"\u7ba1\u9053\u53ea\u80fd\u7528\u4e8e\u6709\u5173\u8054\u7684\u4e24\u4e2a\u8fdb\u7a0b\uff08\u6bd4\u5982\u7236\u3001\u5b50\u8fdb\u7a0b\uff09\u95f4\u7684\u901a\u4fe1\u3002\u800c\u4e0b\u9762\u8981\u8ba8\u8bba\u76843\u79cdSystem V IPC\u80fd\u7528\u4e8e\u65e0\u5173\u8054\u7684\u591a\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\uff0c\u56e0\u4e3a\u5b83\u4eec\u90fd\u4f7f\u7528\u4e00\u4e2a\u5168\u5c40\u552f\u4e00\u7684\u952e\u503c\u6765\u6807\u8bc6\u4e00\u6761\u4fe1\u9053\u3002"),(0,l.kt)("p",null,"\u6709\u4e00\u79cd\u7279\u6b8a\u7684\u7ba1\u9053\u79f0\u4e3aFIFOFirst In First Out\uff0c\u5148\u8fdb\u5148\u51fa\uff09\uff0c\u4e5f\u53eb\u547d\u540d\u7ba1\u9053\u3002\u5b83\u4e5f\u80fd\u7528\u4e8e\u65e0\u5173\u8054\u8fdb\u7a0b\u4e4b\u95f4\u7684\u901a\u4fe1\u3002"),(0,l.kt)("p",null,"\u6240\u6709\u7684\u7ba1\u9053\u90fd\u9075\u5faa\u5148\u8fdb\u5148\u51fa\u7684\u539f\u5219\u3002"),(0,l.kt)("h3",{id:"\u4fe1\u53f7\u91cfsemaphore"},"\u4fe1\u53f7\u91cf\uff08Semaphore\uff09"),(0,l.kt)("h4",{id:"\u4fe1\u53f7\u91cf\u539f\u8bed"},"\u4fe1\u53f7\u91cf\u539f\u8bed"),(0,l.kt)("p",null,"\u5f53\u591a\u4e2a\u8fdb\u7a0b\u540c\u65f6\u8bbf\u95ee\u7cfb\u7edf\u4e0a\u7684\u67d0\u4e2a\u8d44\u6e90\u7684\u65f6\u5019\uff0c\u6bd4\u5982\u540c\u65f6\u5199\u4e00\u4e2a\u6570\u636e\u5e93\u7684\u67d0\u6761\u8bb0\u5f55\uff0c\u6216\u8005\u540c\u65f6\u4fee\u6539\u67d0\u4e2a\u6587\u4ef6\uff0c\u5c31\u9700\u8981\u8003\u8651\u8fdb\u7a0b\u7684\u540c\u6b65\u95ee\u9898\uff0c\u4ee5\u786e\u4fdd\u4efb\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u8fdb\u7a0b\u53ef\u4ee5\u62e5\u6709\u5bf9\u8d44\u6e90\u7684\u72ec\u5360\u5f0f\u8bbf\u95ee\u3002\u901a\u5e38\uff0c\u7a0b\u5e8f\u5bf9\u5171\u4eab\u8d44\u6e90\u7684\u8bbf\u95ee\u7684\u4ee3\u7801\u53ea\u662f\u5f88\u77ed\u7684\u4e00\u6bb5\uff0c\u4f46\u5c31\u662f\u8fd9\u4e00\u6bb5\u4ee3\u7801\u5f15\u53d1\u4e86\u8fdb\u7a0b\u4e4b\u95f4\u7684\u7ade\u6001\u6761\u4ef6\u3002\u6211\u4eec\u79f0\u8fd9\u6bb5\u4ee3\u7801\u4e3a\u5173\u952e\u4ee3\u7801\u6bb5\uff0c\u6216\u8005\u4e34\u754c\u533a\u3002\u5bf9\u8fdb\u7a0b\u540c\u6b65\uff0c\u4e5f\u5c31\u662f\u786e\u4fdd\u4efb\u4e00\u65f6\u523b\u53ea\u6709\u4e00\u4e2a\u8fdb\u7a0b\u80fd\u8fdb\u5165\u5173\u952e\u4ee3\u7801\u6bb5\u3002"),(0,l.kt)("p",null,"\u4fe1\u53f7\u91cf\u662f\u4e00\u79cd\u7279\u6b8a\u7684\u53d8\u91cf\uff0c\u5b83\u53ea\u80fd\u53d6\u81ea\u7136\u6570\u503c\u5e76\u4e14\u53ea\u652f\u6301\u4e24\u79cd\u64cd\u4f5c\uff1a\u7b49\u5f85\uff08wait\uff09\u548c\u4fe1\u53f7\uff08signal\uff09\u3002\u4e0d\u8fc7\u5728Linux/UNIX\u4e2d\uff0c\u201c\u7b49\u5f85\u201d\u548c\u201c\u4fe1\u53f7\u201d\u90fd\u5df2\u7ecf\u5177\u6709\u7279\u6b8a\u7684\u542b\u4e49\uff0c\u6240\u4ee5\u5bf9\u4fe1\u53f7\u91cf\u7684\u8fd9\u4e24\u79cd\u64cd\u4f5c\u66f4\u5e38\u7528\u7684\u79f0\u547c\u662fP\u3001V\u64cd\u4f5c\u3002\u8377\u5170\u8bed\u5355\u8bcdpasseren\uff08\u4f20\u9012\uff0c\u5c31\u597d\u50cf\u8fdb\u5165\u4e34\u754c\u533a\uff09\u548cvrijgeven\uff08\u91ca\u653e\uff0c\u5c31\u597d\u50cf\u9000\u51fa\u4e34\u754c\u533a\uff09\u3002"),(0,l.kt)("p",null,"\u5047\u8bbe\u6709\u4fe1\u53f7\u91cfSV\uff0c\u5219\u5bf9\u5b83\u7684P\u3001V\u64cd\u4f5c\u542b\u4e49\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"P(SV)\uff0c\u5982\u679cSV\u7684\u503c\u5927\u4e8e0\uff0c\u5c31\u5c06\u5b83\u51cf1\uff1b\u5982\u679cSV\u7684\u503c\u4e3a0\uff0c\u5219\u6302\u8d77\u8fdb\u7a0b\u7684\u6267\u884c\u3002"),(0,l.kt)("li",{parentName:"ul"},"V(SV)\uff0c\u5982\u679c\u6709\u5176\u4ed6\u8fdb\u7a0b\u56e0\u4e3a\u7b49\u5f85SV\u800c\u6302\u8d77\uff0c\u5219\u5524\u9192\u4e4b\uff1b\u5982\u679c\u6ca1\u6709\uff0c\u5219\u5c06SV\u52a01\u3002")),(0,l.kt)("p",null,"\u4fe1\u53f7\u91cf\u7684\u53d6\u503c\u53ef\u4ee5\u662f\u4efb\u4f55\u81ea\u7136\u6570\u3002\u4f46\u6700\u5e38\u7528\u7684\u3001\u6700\u7b80\u5355\u7684\u4fe1\u53f7\u91cf\u662f\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\uff0c\u5b83\u53ea\u80fd\u53d60\u548c1\u8fd9\u4e24\u4e2a\u503c\u3002\u672c\u4e66\u4ec5\u8ba8\u8bba\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\u3002\u4f7f\u7528\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\u540c\u6b65\u4e24\u4e2a\u8fdb\u7a0b\uff0c\u4ee5\u786e\u4fdd\u5173\u952e\u4ee3\u7801\u6bb5\u7684\u72ec\u5360\u5f0f\u8bbf\u95ee\u7684\u4e00\u4e2a\u5178\u578b\u4f8b\u5b50"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20210910164111640",src:n(41962).Z})),(0,l.kt)("p",null,"\u5f53\u5173\u952e\u4ee3\u7801\u6bb5\u53ef\u7528\u65f6\uff0c\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cfSV\u7684\u503c\u4e3a1\uff0c\u8fdb\u7a0bA\u548cB\u90fd\u6709\u673a\u4f1a\u8fdb\u5165\u5173\u952e\u4ee3\u7801\u6bb5\u3002\u5982\u679c\u6b64\u65f6\u8fdb\u7a0bA\u6267\u884c\u4e86P(SV)\u64cd\u4f5c\u5c06SV\u51cf1\uff0c\u5219\u8fdb\u7a0bB\u82e5\u518d\u6267\u884cP(SV)\u64cd\u4f5c\u5c31\u4f1a\u88ab\u6302\u8d77\u3002\u76f4\u5230\u8fdb\u7a0bA\u79bb\u5f00\u5173\u952e\u4ee3\u7801\u6bb5\uff0c\u5e76\u6267\u884cV(SV)\u64cd\u4f5c\u5c06SV\u52a01\uff0c\u5173\u952e\u4ee3\u7801\u6bb5\u624d\u91cd\u65b0\u53d8\u5f97\u53ef\u7528\u3002\u5982\u679c\u6b64\u65f6\u8fdb\u7a0bB\u56e0\u4e3a\u7b49\u5f85SV\u800c\u5904\u4e8e\u6302\u8d77\u72b6\u6001\uff0c\u5219\u5b83\u5c06\u88ab\u5524\u9192\uff0c\u5e76\u8fdb\u5165\u5173\u952e\u4ee3\u7801\u6bb5\u3002\u540c\u6837\uff0c\u8fd9\u65f6\u8fdb\u7a0bA\u5982\u679c\u518d\u6267\u884cP(SV)\u64cd\u4f5c\uff0c\u5219\u4e5f\u53ea\u80fd\u88ab\u64cd\u4f5c\u7cfb\u7edf\u6302\u8d77\u4ee5\u7b49\u5f85\u8fdb\u7a0bB\u9000\u51fa\u5173\u952e\u4ee3\u7801\u6bb5\u3002"),(0,l.kt)("p",null,"\u6ce8\u610f\u3000\u4f7f\u7528\u4e00\u4e2a\u666e\u901a\u53d8\u91cf\u6765\u6a21\u62df\u4e8c\u8fdb\u5236\u4fe1\u53f7\u91cf\u662f\u884c\u4e0d\u901a\u7684\uff0c\u56e0\u4e3a\u6240\u6709\u9ad8\u7ea7\u8bed\u8a00\u90fd\u6ca1\u6709\u4e00\u4e2a\u539f\u5b50\u64cd\u4f5c\u53ef\u4ee5\u540c\u65f6\u5b8c\u6210\u5982\u4e0b\u4e24\u6b65\u64cd\u4f5c\uff1a\u68c0\u6d4b\u53d8\u91cf\u662f\u5426\u4e3atrue/false\uff0c\u5982\u679c\u662f\u5219\u518d\u5c06\u5b83\u8bbe\u7f6e\u4e3afalse/true\u3002"),(0,l.kt)("p",null,"Linux\u4fe1\u53f7\u91cf\u7684API\u90fd\u5b9a\u4e49\u5728sys/sem.h\u5934\u6587\u4ef6\u4e2d\uff0c\u4e3b\u8981\u5305\u542b3\u4e2a\u7cfb\u7edf\u8c03\u7528\uff1asemget\u3001semop\u548csemctl\u3002\u5b83\u4eec\u90fd\u88ab\u8bbe\u8ba1\u4e3a\u64cd\u4f5c\u4e00\u7ec4\u4fe1\u53f7\u91cf\uff0c\u5373\u4fe1\u53f7\u91cf\u96c6\uff0c\u800c\u4e0d\u662f\u5355\u4e2a\u4fe1\u53f7\u91cf"),(0,l.kt)("h4",{id:"semget\u7cfb\u7edf\u8c03\u7528"},"semget\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"semget\u7cfb\u7edf\u8c03\u7528\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4fe1\u53f7\u91cf\u96c6\uff0c\u6216\u8005\u83b7\u53d6\u4e00\u4e2a\u5df2\u7ecf\u5b58\u5728\u7684\u4fe1\u53f7\u91cf\u96c6\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <sys/sem.h>\nint semget(key_t key,int num_sems,int sem_flags);\n")),(0,l.kt)("p",null,"key\u53c2\u6570\u662f\u4e00\u4e2a\u952e\u503c\uff0c\u7528\u6765\u6807\u8bc6\u4e00\u4e2a\u5168\u5c40\u552f\u4e00\u7684\u4fe1\u53f7\u91cf\u96c6\uff0c\u5c31\u50cf\u6587\u4ef6\u540d\u5168\u5c40\u552f\u4e00\u5730\u6807\u8bc6\u4e00\u4e2a\u6587\u4ef6\u4e00\u6837\u3002\u8981\u901a\u8fc7\u4fe1\u53f7\u91cf\u901a\u4fe1\u7684\u8fdb\u7a0b\u9700\u8981\u4f7f\u7528\u76f8\u540c\u7684\u952e\u503c\u6765\u521b\u5efa/\u83b7\u53d6\u8be5\u4fe1\u53f7\u91cf\u3002"),(0,l.kt)("p",null,"num_sems\u53c2\u6570\u6307\u5b9a\u8981\u521b\u5efa/\u83b7\u53d6\u7684\u4fe1\u53f7\u91cf\u96c6\u4e2d\u4fe1\u53f7\u91cf\u7684\u6570\u76ee\u3002\u5982\u679c\u662f\u521b\u5efa\u4fe1\u53f7\u91cf\uff0c\u5219\u8be5\u503c\u5fc5\u987b\u88ab\u6307\u5b9a\uff1b\u5982\u679c\u662f\u83b7\u53d6\u5df2\u7ecf\u5b58\u5728\u7684\u4fe1\u53f7\u91cf\uff0c\u5219\u53ef\u4ee5\u628a\u5b83\u8bbe\u7f6e\u4e3a0\u3002"),(0,l.kt)("p",null,"sem_flags\u53c2\u6570\u6307\u5b9a\u4e00\u7ec4\u6807\u5fd7\u3002\u5b83\u4f4e\u7aef\u76849\u4e2a\u6bd4\u7279\u662f\u8be5\u4fe1\u53f7\u91cf\u7684\u6743\u9650\uff0c\u5176\u683c\u5f0f\u548c\u542b\u4e49\u90fd\u4e0e\u7cfb\u7edf\u8c03\u7528open\u7684mode\u53c2\u6570\u76f8\u540c\u3002\u6b64\u5916\uff0c\u5b83\u8fd8\u53ef\u4ee5\u548cIPC_CREAT\u6807\u5fd7\u505a\u6309\u4f4d\u201c\u6216\u201d\u8fd0\u7b97\u4ee5\u521b\u5efa\u65b0\u7684\u4fe1\u53f7\u91cf\u96c6\u3002\u6b64\u65f6\u5373\u4f7f\u4fe1\u53f7\u91cf\u5df2\u7ecf\u5b58\u5728\uff0csemget\u4e5f\u4e0d\u4f1a\u4ea7\u751f\u9519\u8bef\u3002\u6211\u4eec\u8fd8\u53ef\u4ee5\u8054\u5408\u4f7f\u7528IPC_CREAT\u548cIPC_EXCL\u6807\u5fd7\u6765\u786e\u4fdd\u521b\u5efa\u4e00\u7ec4\u65b0\u7684\u3001\u552f\u4e00\u7684\u4fe1\u53f7\u91cf\u96c6\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5982\u679c\u4fe1\u53f7\u91cf\u96c6\u5df2\u7ecf\u5b58\u5728\uff0c\u5219semget\u8fd4\u56de\u9519\u8bef\u5e76\u8bbe\u7f6eerrno\u4e3aEEXIST\u3002\u8fd9\u79cd\u521b\u5efa\u4fe1\u53f7\u91cf\u7684\u884c\u4e3a\u4e0e\u7528O_CREAT\u548cO_EXCL\u6807\u5fd7\u8c03\u7528open\u6765\u6392\u4ed6\u5f0f\u5730\u6253\u5f00\u4e00\u4e2a\u6587\u4ef6\u76f8\u4f3c\u3002"),(0,l.kt)("p",null,"semget\u6210\u529f\u65f6\u8fd4\u56de\u4e00\u4e2a\u6b63\u6574\u6570\u503c\uff0c\u5b83\u662f\u4fe1\u53f7\u91cf\u96c6\u7684\u6807\u8bc6\u7b26\uff1bsemget\u5931\u8d25\u65f6\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("p",null,"\u5982\u679csemget\u7528\u4e8e\u521b\u5efa\u4fe1\u53f7\u91cf\u96c6\uff0c\u5219\u4e0e\u4e4b\u5173\u8054\u7684\u5185\u6838\u6570\u636e\u7ed3\u6784\u4f53semid_ds\u5c06\u88ab\u521b\u5efa\u5e76\u521d\u59cb\u5316\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include<sys/sem.h>\n/*\u8be5\u7ed3\u6784\u4f53\u7528\u4e8e\u63cf\u8ff0IPC\u5bf9\u8c61\uff08\u4fe1\u53f7\u91cf\u3001\u5171\u4eab\u5185\u5b58\u548c\u6d88\u606f\u961f\u5217\uff09\u7684\u6743\u9650*/\nstruct ipc_perm\n{\n    key_t key;/*\u952e\u503c*/\n    uid_t uid;/*\u6240\u6709\u8005\u7684\u6709\u6548\u7528\u6237ID*/\n    gid_t gid;/*\u6240\u6709\u8005\u7684\u6709\u6548\u7ec4ID*/\n    uid_t cuid;/*\u521b\u5efa\u8005\u7684\u6709\u6548\u7528\u6237ID*/\n    gid_t cgid;/*\u521b\u5efa\u8005\u7684\u6709\u6548\u7ec4ID*/\n    mode_t mode;/*\u8bbf\u95ee\u6743\u9650*/\n    /*\u7701\u7565\u5176\u4ed6\u586b\u5145\u5b57\u6bb5*/\n}\nstruct semid_ds\n{\n    struct ipc_perm sem_perm;/*\u4fe1\u53f7\u91cf\u7684\u64cd\u4f5c\u6743\u9650*/\n    unsigned long int sem_nsems;/*\u8be5\u4fe1\u53f7\u91cf\u96c6\u4e2d\u7684\u4fe1\u53f7\u91cf\u6570\u76ee*/\n    time_t sem_otime;/*\u6700\u540e\u4e00\u6b21\u8c03\u7528semop\u7684\u65f6\u95f4*/\n    time_t sem_ctime;/*\u6700\u540e\u4e00\u6b21\u8c03\u7528semctl\u7684\u65f6\u95f4*/\n    /*\u7701\u7565\u5176\u4ed6\u586b\u5145\u5b57\u6bb5*/\n};\n\n")),(0,l.kt)("p",null,"semget\u5bf9semid_ds\u7ed3\u6784\u4f53\u7684\u521d\u59cb\u5316\u5305\u62ec\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5c06sem_perm.cuid\u548csem_perm.uid\u8bbe\u7f6e\u4e3a\u8c03\u7528\u8fdb\u7a0b\u7684\u6709\u6548\u7528\u6237ID\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06sem_perm.cgid\u548csem_perm.gid\u8bbe\u7f6e\u4e3a\u8c03\u7528\u8fdb\u7a0b\u7684\u6709\u6548\u7ec4ID\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06sem_perm.mode\u7684\u6700\u4f4e9\u4f4d\u8bbe\u7f6e\u4e3asem_flags\u53c2\u6570\u7684\u6700\u4f4e9\u4f4d\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06sem_nsems\u8bbe\u7f6e\u4e3anum_sems\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06sem_otime\u8bbe\u7f6e\u4e3a0\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06sem_ctime\u8bbe\u7f6e\u4e3a\u5f53\u524d\u7684\u7cfb\u7edf\u65f6\u95f4\u3002")),(0,l.kt)("h4",{id:"semop\u7cfb\u7edf\u8c03\u7528"},"semop\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"semop\u7cfb\u7edf\u8c03\u7528\u6539\u53d8\u4fe1\u53f7\u91cf\u7684\u503c\uff0c\u5373\u6267\u884cP\u3001V\u64cd\u4f5c\u3002\u4e0e\u6bcf\u4e2a\u4fe1\u53f7\u91cf\u5173\u8054\u7684\u4e00\u4e9b\u91cd\u8981\u7684\u5185\u6838\u53d8\u91cf\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"unsigned short semval;\n/*\u4fe1\u53f7\u91cf\u7684\u503c*/\nunsigned short semzcnt;\n/*\u7b49\u5f85\u4fe1\u53f7\u91cf\u503c\u53d8\u4e3a0\u7684\u8fdb\u7a0b\u6570\u91cf*/\nunsigned short semncnt;\n/*\u7b49\u5f85\u4fe1\u53f7\u91cf\u503c\u589e\u52a0\u7684\u8fdb\u7a0b\u6570\u91cf*/\npid_t sempid;\n/*\u6700\u540e\u4e00\u6b21\u6267\u884csemop\u64cd\u4f5c\u7684\u8fdb\u7a0bID*/\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"int semop(int sem_id,struct sembuf*sem_ops,size_t num_sem_ops);\n")),(0,l.kt)("p",null,"sem_id\u53c2\u6570\u662f\u7531semget\u8c03\u7528\u8fd4\u56de\u7684\u4fe1\u53f7\u91cf\u96c6\u6807\u8bc6\u7b26\uff0c\u7528\u4ee5\u6307\u5b9a\u88ab\u64cd\u4f5c\u7684\u76ee\u6807\u4fe1\u53f7\u91cf\u96c6\u3002sem_ops\u53c2\u6570\u6307\u5411\u4e00\u4e2asembuf\u7ed3\u6784\u4f53\u7c7b\u578b\u7684\u6570\u7ec4"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"struct sembuf{\n    unsigned short int sem_num;short int sem_op;\n    short int sem_flg;\n}\n")),(0,l.kt)("p",null,"sem_num\u6210\u5458\u662f\u4fe1\u53f7\u91cf\u96c6\u4e2d\u4fe1\u53f7\u91cf\u7684\u7f16\u53f7\uff0c0\u8868\u793a\u4fe1\u53f7\u91cf\u96c6\u4e2d\u7684\u7b2c\u4e00\u4e2a\u4fe1\u53f7\u91cf\u3002sem_op\u6210\u5458\u6307\u5b9a\u64cd\u4f5c\u7c7b\u578b\uff0c\u5176\u53ef\u9009\u503c\u4e3a\u6b63\u6574\u6570\u30010\u548c\u8d1f\u6574\u6570\u3002\u6bcf\u79cd\u7c7b\u578b\u7684\u64cd\u4f5c\u7684\u884c\u4e3a\u53c8\u53d7\u5230sem_flg\u6210\u5458\u7684\u5f71\u54cd\u3002sem_flg\u7684\u53ef\u9009\u503c\u662fIPC_NOWAIT\u548cSEM_UNDO\u3002IPC_NOWAIT\u7684\u542b\u4e49\u662f\uff0c\u65e0\u8bba\u4fe1\u53f7\u91cf\u64cd\u4f5c\u662f\u5426\u6210\u529f\uff0csemop\u8c03\u7528\u90fd\u5c06\u7acb\u5373\u8fd4\u56de\uff0c\u8fd9\u7c7b\u4f3c\u4e8e\u975e\u963b\u585eI/O\u64cd\u4f5c\u3002SEM_UNDO\u7684\u542b\u4e49\u662f\uff0c\u5f53\u8fdb\u7a0b\u9000\u51fa\u65f6\u53d6\u6d88\u6b63\u5728\u8fdb\u884c\u7684semop\u64cd\u4f5c\u3002\u5177\u4f53\u6765\u8bf4\uff0csem_op\u548csem_flg\u5c06\u6309\u7167\u5982\u4e0b\u65b9\u5f0f\u6765\u5f71\u54cdsemop\u7684\u884c\u4e3a\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5982\u679csem_op\u5927\u4e8e0\uff0c\u5219semop\u5c06\u88ab\u64cd\u4f5c\u7684\u4fe1\u53f7\u91cf\u7684\u503csemval\u589e\u52a0sem_op\u3002\u8be5\u64cd\u4f5c\u8981\u6c42\u8c03\u7528\u8fdb\u7a0b\u5bf9\u88ab\u64cd\u4f5c\u4fe1\u53f7\u91cf\u96c6\u62e5\u6709\u5199\u6743\u9650\u3002\u6b64\u65f6\u82e5\u8bbe\u7f6e\u4e86SEM_UNDO\u6807\u5fd7\uff0c\u5219\u7cfb\u7edf\u5c06\u66f4\u65b0\u8fdb\u7a0b\u7684semadj\u53d8\u91cf\uff08\u7528\u4ee5\u8ddf\u8e2a\u8fdb\u7a0b\u5bf9\u4fe1\u53f7\u91cf\u7684\u4fee\u6539\u60c5\u51b5\uff09\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5982\u679csem_op\u7b49\u4e8e0\uff0c\u5219\u8868\u793a\u8fd9\u662f\u4e00\u4e2a\u201c\u7b49\u5f850\u201d\uff08wait-for-zero\uff09\u64cd\u4f5c\u3002\u8be5\u64cd\u4f5c\u8981\u6c42\u8c03\u7528\u8fdb\u7a0b\u5bf9\u88ab\u64cd\u4f5c\u4fe1\u53f7\u91cf\u96c6\u62e5\u6709\u8bfb\u6743\u9650\u3002\u5982\u679c\u6b64\u65f6\u4fe1\u53f7\u91cf\u7684\u503c\u662f0\uff0c\u5219\u8c03\u7528\u7acb\u5373\u6210\u529f\u8fd4\u56de\u3002\u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503c\u4e0d\u662f0\uff0c\u5219semop\u5931\u8d25\u8fd4\u56de\u6216\u8005\u963b\u585e\u8fdb\u7a0b\u4ee5\u7b49\u5f85\u4fe1\u53f7\u91cf\u53d8\u4e3a0\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53IPC_NOWAIT\u6807\u5fd7\u88ab\u6307\u5b9a\u65f6\uff0csemop\u7acb\u5373\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\uff0c\u5e76\u8bbe\u7f6eerrno\u4e3aEAGAIN\u3002\u5982\u679c\u672a\u6307\u5b9aIPC_NOWAIT\u6807\u5fd7\uff0c\u5219\u4fe1\u53f7\u91cf\u7684semzcnt\u503c\u52a01\uff0c\u8fdb\u7a0b\u88ab\u6295\u5165\u7761\u7720\u76f4\u5230\u4e0b\u52173\u4e2a\u6761\u4ef6\u4e4b\u4e00\u53d1\u751f\uff1a\u4fe1\u53f7\u91cf\u7684\u503csemval\u53d8\u4e3a0\uff0c\u6b64\u65f6\u7cfb\u7edf\u5c06\u8be5\u4fe1\u53f7\u91cf\u7684semzcnt\u503c\u51cf1\uff1b\u88ab\u64cd\u4f5c\u4fe1\u53f7\u91cf\u6240\u5728\u7684\u4fe1\u53f7\u91cf\u96c6\u88ab\u8fdb\u7a0b\u79fb\u9664\uff0c\u6b64\u65f6semop\u8c03\u7528\u5931\u8d25\u8fd4\u56de\uff0cerrno\u88ab\u8bbe\u7f6e\u4e3aEIDRM\uff1b\u8c03\u7528\u88ab\u4fe1\u53f7\u4e2d\u65ad\uff0c\u6b64\u65f6semop\u8c03\u7528\u5931\u8d25\u8fd4\u56de\uff0cerrno\u88ab\u8bbe\u7f6e\u4e3aEINTR\uff0c\u540c\u65f6\u7cfb\u7edf\u5c06\u8be5\u4fe1\u53f7\u91cf\u7684semzcnt\u503c\u51cf1\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5982\u679csem_op\u5c0f\u4e8e0\uff0c\u5219\u8868\u793a\u5bf9\u4fe1\u53f7\u91cf\u503c\u8fdb\u884c\u51cf\u64cd\u4f5c\uff0c\u5373\u671f\u671b\u83b7\u5f97\u4fe1\u53f7\u91cf\u3002\u8be5\u64cd\u4f5c\u8981\u6c42\u8c03\u7528\u8fdb\u7a0b\u5bf9\u88ab\u64cd\u4f5c\u4fe1\u53f7\u91cf\u96c6\u62e5\u6709\u5199\u6743\u9650\u3002\u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503csemval\u5927\u4e8e\u6216\u7b49\u4e8esem_op\u7684\u7edd\u5bf9\u503c\uff0c\u5219semop\u64cd\u4f5c\u6210\u529f\uff0c\u8c03\u7528\u8fdb\u7a0b\u7acb\u5373\u83b7\u5f97\u4fe1\u53f7\u91cf\uff0c\u5e76\u4e14\u7cfb\u7edf\u5c06\u8be5\u4fe1\u53f7\u91cf\u7684semval\u503c\u51cf\u53bbsem_op\u7684\u7edd\u5bf9\u503c\u3002\u6b64\u65f6\u5982\u679c\u8bbe\u7f6e\u4e86SEM_UNDO\u6807\u5fd7\uff0c\u5219\u7cfb\u7edf\u5c06\u66f4\u65b0\u8fdb\u7a0b\u7684semadj\u53d8\u91cf\u3002\u5982\u679c\u4fe1\u53f7\u91cf\u7684\u503csemval\u5c0f\u4e8esem_op\u7684\u7edd\u5bf9\u503c\uff0c\u5219semop\u5931\u8d25\u8fd4\u56de\u6216\u8005\u963b\u585e\u8fdb\u7a0b\u4ee5\u7b49\u5f85\u4fe1\u53f7\u91cf\u53ef\u7528\u3002\u5728\u8fd9\u79cd\u60c5\u51b5\u4e0b\uff0c\u5f53IPC_NOWAIT\u6807\u5fd7\u88ab\u6307\u5b9a\u65f6\uff0csemop\u7acb\u5373\u8fd4\u56de\u4e00\u4e2a\u9519\u8bef\uff0c\u5e76\u8bbe\u7f6eerrno\u4e3aEAGAIN\u3002\u5982\u679c\u672a\u6307\u5b9aIPC_NOWAIT\u6807\u5fd7\uff0c\u5219\u4fe1\u53f7\u91cf\u7684semncnt\u503c\u52a01\uff0c\u8fdb\u7a0b\u88ab\u6295\u5165\u7761\u7720\u76f4\u5230\u4e0b\u52173\u4e2a\u6761\u4ef6\u4e4b\u4e00\u53d1\u751f\uff1a\u4fe1\u53f7\u91cf\u7684\u503csemval\u53d8\u5f97\u5927\u4e8e\u6216\u7b49\u4e8esem_op\u7684\u7edd\u5bf9\u503c\uff0c\u6b64\u65f6\u7cfb\u7edf\u5c06\u8be5\u4fe1\u53f7\u91cf\u7684semncnt\u503c\u51cf1\uff0c\u5e76\u5c06semval\u51cf\u53bbsem_op\u7684\u7edd\u5bf9\u503c\uff0c\u540c\u65f6\uff0c\u5982\u679cSEM_UNDO\u6807\u5fd7\u88ab\u8bbe\u7f6e\uff0c\u5219\u7cfb\u7edf\u66f4\u65b0semadj\u53d8\u91cf\uff1b\u88ab\u64cd\u4f5c\u4fe1\u53f7\u91cf\u6240\u5728\u7684\u4fe1\u53f7\u91cf\u96c6\u88ab\u8fdb\u7a0b\u79fb\u9664\uff0c\u6b64\u65f6semop\u8c03\u7528\u5931\u8d25\u8fd4\u56de\uff0cerrno\u88ab\u8bbe\u7f6e\u4e3aEIDRM\uff1b\u8c03\u7528\u88ab\u4fe1\u53f7\u4e2d\u65ad\uff0c\u6b64\u65f6semop\u8c03\u7528\u5931\u8d25\u8fd4\u56de\uff0cerrno\u88ab\u8bbe\u7f6e\u4e3aEINTR\uff0c\u540c\u65f6\u7cfb\u7edf\u5c06\u8be5\u4fe1\u53f7\u91cf\u7684semncnt\u503c\u51cf1\u3002"))),(0,l.kt)("p",null,"semop\u7cfb\u7edf\u8c03\u7528\u7684\u7b2c3\u4e2a\u53c2\u6570num_sem_ops\u6307\u5b9a\u8981\u6267\u884c\u7684\u64cd\u4f5c\u4e2a\u6570\uff0c\u5373sem_ops\u6570\u7ec4\u4e2d\u5143\u7d20\u7684\u4e2a\u6570\u3002semop\u5bf9\u6570\u7ec4sem_ops\u4e2d\u7684\u6bcf\u4e2a\u6210\u5458\u6309\u7167\u6570\u7ec4\u987a\u5e8f\u4f9d\u6b21\u6267\u884c\u64cd\u4f5c\uff0c\u5e76\u4e14\u8be5\u8fc7\u7a0b\u662f\u539f\u5b50\u64cd\u4f5c\uff0c\u4ee5\u907f\u514d\u522b\u7684\u8fdb\u7a0b\u5728\u540c\u4e00\u65f6\u523b\u6309\u7167\u4e0d\u540c\u7684\u987a\u5e8f\u5bf9\u8be5\u4fe1\u53f7\u96c6\u4e2d\u7684\u4fe1\u53f7\u91cf\u6267\u884csemop\u64cd\u4f5c\u5bfc\u81f4\u7684\u7ade\u6001\u6761\u4ef6\u3002"),(0,l.kt)("p",null,"semop\u6210\u529f\u65f6\u8fd4\u56de0\uff0c\u5931\u8d25\u5219\u8fd4\u56de-1\u5e76\u8bbe\u7f6eerrno\u3002\u5931\u8d25\u7684\u65f6\u5019\uff0csem_ops\u6570\u7ec4\u4e2d\u6307\u5b9a\u7684\u6240\u6709\u64cd\u4f5c\u90fd\u4e0d\u88ab\u6267\u884c\u3002"),(0,l.kt)("h4",{id:"semctl\u7cfb\u7edf\u8c03\u7528"},"semctl\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"int semctl(int sem_id,int sem_num,int command,...);\n")),(0,l.kt)("p",null,"sem_id\u53c2\u6570\u662f\u7531semget\u8c03\u7528\u8fd4\u56de\u7684\u4fe1\u53f7\u91cf\u96c6\u6807\u8bc6\u7b26\uff0c\u7528\u4ee5\u6307\u5b9a\u88ab\u64cd\u4f5c\u7684\u4fe1\u53f7\u91cf\u96c6\u3002sem_num\u53c2\u6570\u6307\u5b9a\u88ab\u64cd\u4f5c\u7684\u4fe1\u53f7\u91cf\u5728\u4fe1\u53f7\u91cf\u96c6\u4e2d\u7684\u7f16\u53f7\u3002command\u53c2\u6570\u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002\u6709\u7684\u547d\u4ee4\u9700\u8981\u8c03\u7528\u8005\u4f20\u9012\u7b2c4\u4e2a\u53c2\u6570\u3002\u7b2c4\u4e2a\u53c2\u6570\u7684\u7c7b\u578b\u7531\u7528\u6237\u81ea\u5df1\u5b9a\u4e49\uff0c\u4f46sys/sem.h\u5934\u6587\u4ef6\u7ed9\u51fa\u4e86\u5b83\u7684\u63a8\u8350\u683c\u5f0f"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"union semun\n{\n    int val;/*\u7528\u4e8eSETVAL\u547d\u4ee4*/\n    struct semid_ds*buf;/*\u7528\u4e8eIPC_STAT\u548cIPC_SET\u547d\u4ee4*/\n    unsigned short*array;/*\u7528\u4e8eGETALL\u548cSETALL\u547d\u4ee4*/\n    struct seminfo*__buf;/*\u7528\u4e8eIPC_INFO\u547d\u4ee4*/\n};\nstruct seminfo\n{\n    int semmap;/*Linux\u5185\u6838\u6ca1\u6709\u4f7f\u7528*/\n    int semmni;/*\u7cfb\u7edf\u6700\u591a\u53ef\u4ee5\u62e5\u6709\u7684\u4fe1\u53f7\u91cf\u96c6\u6570\u76ee*/\n    int semmns;/*\u7cfb\u7edf\u6700\u591a\u53ef\u4ee5\u62e5\u6709\u7684\u4fe1\u53f7\u91cf\u6570\u76ee*/\n    int semmnu;/*Linux\u5185\u6838\u6ca1\u6709\u4f7f\u7528*/\n    int semmsl;/*\u4e00\u4e2a\u4fe1\u53f7\u91cf\u96c6\u6700\u591a\u5141\u8bb8\u5305\u542b\u7684\u4fe1\u53f7\u91cf\u6570\u76ee*/\n    int semopm;/*semop\u4e00\u6b21\u6700\u591a\u80fd\u6267\u884c\u7684sem_op\u64cd\u4f5c\u6570\u76ee*/\n    int semume;/*Linux\u5185\u6838\u6ca1\u6709\u4f7f\u7528*/\n    int semusz;/*sem_undo\u7ed3\u6784\u4f53\u7684\u5927\u5c0f*/\n    int semvmx;/*\u6700\u5927\u5141\u8bb8\u7684\u4fe1\u53f7\u91cf\u503c*/\n    /*\u6700\u591a\u5141\u8bb8\u7684UNDO\u6b21\u6570\uff08\u5e26SEM_UNDO\u6807\u5fd7\u7684semop\u64cd\u4f5c\u7684\u6b21\u6570\uff09*/\n    int semaem;\n};\n\n")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20210910165101598",src:n(92032).Z})),(0,l.kt)("p",null,"\u6ce8\u610f\u3000\u8fd9\u4e9b\u64cd\u4f5c\u4e2d\uff0cGETNCNT\u3001GETPID\u3001GETVAL\u3001GETZCNT\u548cSETVAL\u64cd\u4f5c\u7684\u662f\u5355\u4e2a\u4fe1\u53f7\u91cf\uff0c\u5b83\u662f\u7531\u6807\u8bc6\u7b26sem_id\u6307\u5b9a\u7684\u4fe1\u53f7\u91cf\u96c6\u4e2d\u7684\u7b2csem_num\u4e2a\u4fe1\u53f7\u91cf\uff1b\u800c\u5176\u4ed6\u64cd\u4f5c\u9488\u5bf9\u7684\u662f\u6574\u4e2a\u4fe1\u53f7\u91cf\u96c6\uff0c\u6b64\u65f6semctl\u7684\u53c2\u6570sem_num\u88ab\u5ffd\u7565\u3002"),(0,l.kt)("p",null,"semctl\u6210\u529f\u65f6\u7684\u8fd4\u56de\u503c\u53d6\u51b3\u4e8ecommand\u53c2\u6570\uff0c\u5982\u886813-2\u6240\u793a\u3002semctl\u5931\u8d25\u65f6\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("h4",{id:"\u7279\u6b8a\u952e\u503cipc_private"},"\u7279\u6b8a\u952e\u503cIPC_PRIVATE"),(0,l.kt)("p",null,"semget\u7684\u8c03\u7528\u8005\u53ef\u4ee5\u7ed9\u5176key\u53c2\u6570\u4f20\u9012\u4e00\u4e2a\u7279\u6b8a\u7684\u952e\u503cIPC_PRIVATE\uff08\u5176\u503c\u4e3a0\uff09\uff0c\u8fd9\u6837\u65e0\u8bba\u8be5\u4fe1\u53f7\u91cf\u662f\u5426\u5df2\u7ecf\u5b58\u5728\uff0csemget\u90fd\u5c06\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u4fe1\u53f7\u91cf\u3002\u4f7f\u7528\u8be5\u952e\u503c\u521b\u5efa\u7684\u4fe1\u53f7\u91cf\u5e76\u975e\u50cf\u5b83\u7684\u540d\u5b57\u58f0\u79f0\u7684\u90a3\u6837\u662f\u8fdb\u7a0b\u79c1\u6709\u7684\u3002\u5176\u4ed6\u8fdb\u7a0b\uff0c\u5c24\u5176\u662f\u5b50\u8fdb\u7a0b\uff0c\u4e5f\u6709\u65b9\u6cd5\u6765\u8bbf\u95ee\u8fd9\u4e2a\u4fe1\u53f7\u91cf\u3002\u6240\u4ee5semget\u7684man\u624b\u518c\u7684BUGS\u90e8\u5206\u4e0a\u8bf4\uff0c\u4f7f\u7528\u540d\u5b57IPC_PRIVATE\u6709\u4e9b\u8bef\u5bfc\uff08\u5386\u53f2\u539f\u56e0\uff09\uff0c\u5e94\u8be5\u79f0\u4e3aIPC_NEW\u3002"),(0,l.kt)("h3",{id:"\u5171\u4eab\u5185\u5b58"},"\u5171\u4eab\u5185\u5b58"),(0,l.kt)("p",null,"\u5171\u4eab\u5185\u5b58\u662f\u6700\u9ad8\u6548\u7684IPC\u673a\u5236\uff0c\u56e0\u4e3a\u5b83\u4e0d\u6d89\u53ca\u8fdb\u7a0b\u4e4b\u95f4\u7684\u4efb\u4f55\u6570\u636e\u4f20\u8f93\u3002\u8fd9\u79cd\u9ad8\u6548\u7387\u5e26\u6765\u7684\u95ee\u9898\u662f\uff0c\u6211\u4eec\u5fc5\u987b\u7528\u5176\u4ed6\u8f85\u52a9\u624b\u6bb5\u6765\u540c\u6b65\u8fdb\u7a0b\u5bf9\u5171\u4eab\u5185\u5b58\u7684\u8bbf\u95ee\uff0c\u5426\u5219\u4f1a\u4ea7\u751f\u7ade\u6001\u6761\u4ef6\u3002\u56e0\u6b64\uff0c\u5171\u4eab\u5185\u5b58\u901a\u5e38\u548c\u5176\u4ed6\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\u4e00\u8d77\u4f7f\u7528\u3002"),(0,l.kt)("p",null,"Linux\u5171\u4eab\u5185\u5b58\u7684API\u90fd\u5b9a\u4e49\u5728sys/shm.h\u5934\u6587\u4ef6\u4e2d\uff0c\u5305\u62ec4\u4e2a\u7cfb\u7edf\u8c03\u7528\uff1ashmget\u3001shmat\u3001shmdt\u548cshmctl\u3002"),(0,l.kt)("h4",{id:"shmget\u7cfb\u7edf\u8c03\u7528"},"shmget\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"shmget\u7cfb\u7edf\u8c03\u7528\u521b\u5efa\u4e00\u6bb5\u65b0\u7684\u5171\u4eab\u5185\u5b58\uff0c\u6216\u8005\u83b7\u53d6\u4e00\u6bb5\u5df2\u7ecf\u5b58\u5728\u7684\u5171\u4eab\u5185\u5b58\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include\uff1csys/shm.h\uff1e\nint shmget(key_t key,size_t size,int shmflg);\n")),(0,l.kt)("p",null,"\u548csemget\u7cfb\u7edf\u8c03\u7528\u4e00\u6837\uff0ckey\u53c2\u6570\u662f\u4e00\u4e2a\u952e\u503c\uff0c\u7528\u6765\u6807\u8bc6\u4e00\u6bb5\u5168\u5c40\u552f\u4e00\u7684\u5171\u4eab\u5185\u5b58\u3002size\u53c2\u6570\u6307\u5b9a\u5171\u4eab\u5185\u5b58\u7684\u5927\u5c0f\uff0c\u5355\u4f4d\u662f\u5b57\u8282\u3002\u5982\u679c\u662f\u521b\u5efa\u65b0\u7684\u5171\u4eab\u5185\u5b58\uff0c\u5219size\u503c\u5fc5\u987b\u88ab\u6307\u5b9a\u3002\u5982\u679c\u662f\u83b7\u53d6\u5df2\u7ecf\u5b58\u5728\u7684\u5171\u4eab\u5185\u5b58\uff0c\u5219\u53ef\u4ee5\u628asize\u8bbe\u7f6e\u4e3a0\u3002"),(0,l.kt)("p",null,"shmflg\u53c2\u6570\u7684\u4f7f\u7528\u548c\u542b\u4e49\u4e0esemget\u7cfb\u7edf\u8c03\u7528\u7684sem_flags\u53c2\u6570\u76f8\u540c\u3002\u4e0d\u8fc7shmget\u652f\u6301\u4e24\u4e2a\u989d\u5916\u7684\u6807\u5fd7\u2014\u2014SHM_HUGETLB\u548cSHM_NORESERVE\u3002\u5b83\u4eec\u7684\u542b\u4e49\u5982\u4e0b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"SHM_HUGETLB\uff0c\u7c7b\u4f3c\u4e8emmap\u7684MAP_HUGETLB\u6807\u5fd7\uff0c\u7cfb\u7edf\u5c06\u4f7f\u7528\u201c\u5927\u9875\u9762\u201d\u6765\u4e3a\u5171\u4eab\u5185\u5b58\u5206\u914d\u7a7a\u95f4\u3002"),(0,l.kt)("li",{parentName:"ul"},"SHM_NORESERVE\uff0c\u7c7b\u4f3c\u4e8emmap\u7684MAP_NORESERVE\u6807\u5fd7\uff0c\u4e0d\u4e3a\u5171\u4eab\u5185\u5b58\u4fdd\u7559\u4ea4\u6362\u5206\u533a\uff08swap\u7a7a\u95f4\uff09\u3002\u8fd9\u6837\uff0c\u5f53\u7269\u7406\u5185\u5b58\u4e0d\u8db3\u7684\u65f6\u5019\uff0c\u5bf9\u8be5\u5171\u4eab\u5185\u5b58\u6267\u884c\u5199\u64cd\u4f5c\u5c06\u89e6\u53d1SIGSEGV\u4fe1\u53f7\u3002")),(0,l.kt)("p",null,"shmget\u6210\u529f\u65f6\u8fd4\u56de\u4e00\u4e2a\u6b63\u6574\u6570\u503c\uff0c\u5b83\u662f\u5171\u4eab\u5185\u5b58\u7684\u6807\u8bc6\u7b26\u3002shmget\u5931\u8d25\u65f6\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("p",null,"\u5982\u679cshmget\u7528\u4e8e\u521b\u5efa\u5171\u4eab\u5185\u5b58\uff0c\u5219\u8fd9\u6bb5\u5171\u4eab\u5185\u5b58\u7684\u6240\u6709\u5b57\u8282\u90fd\u88ab\u521d\u59cb\u5316\u4e3a0\uff0c\u4e0e\u4e4b\u5173\u8054\u7684\u5185\u6838\u6570\u636e\u7ed3\u6784shmid_ds\u5c06\u88ab\u521b\u5efa\u5e76\u521d\u59cb\u5316\u3002shmid_ds\u7ed3\u6784\u4f53\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"struct shmid_ds\n{\n    struct ipc_perm shm_perm;/*\u5171\u4eab\u5185\u5b58\u7684\u64cd\u4f5c\u6743\u9650*/\n    size_t shm_segsz;/*\u5171\u4eab\u5185\u5b58\u5927\u5c0f\uff0c\u5355\u4f4d\u662f\u5b57\u8282*/\n    __time_t shm_atime;/*\u5bf9\u8fd9\u6bb5\u5185\u5b58\u6700\u540e\u4e00\u6b21\u8c03\u7528shmat\u7684\u65f6\u95f4*/\n    __time_t shm_dtime;/*\u5bf9\u8fd9\u6bb5\u5185\u5b58\u6700\u540e\u4e00\u6b21\u8c03\u7528shmdt\u7684\u65f6\u95f4*/\n    __time_t shm_ctime;/*\u5bf9\u8fd9\u6bb5\u5185\u5b58\u6700\u540e\u4e00\u6b21\u8c03\u7528shmctl\u7684\u65f6\u95f4*/\n    __pid_t shm_cpid;/*\u521b\u5efa\u8005\u7684PID*/\n    __pid_t shm_lpid;/*\u6700\u540e\u4e00\u6b21\u6267\u884cshmat\u6216shmdt\u64cd\u4f5c\u7684\u8fdb\u7a0b\u7684PID*/\n    shmatt_t shm_nattach;/*\u76ee\u524d\u5173\u8054\u5230\u6b64\u5171\u4eab\u5185\u5b58\u7684\u8fdb\u7a0b\u6570\u91cf*/\n    /*\u7701\u7565\u4e00\u4e9b\u586b\u5145\u5b57\u6bb5*/\n};\n")),(0,l.kt)("p",null,"shmget\u5bf9shmid_ds\u7ed3\u6784\u4f53\u7684\u521d\u59cb\u5316\u5305\u62ec\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06shm_perm.cuid\u548cshm_perm.uid\u8bbe\u7f6e\u4e3a\u8c03\u7528\u8fdb\u7a0b\u7684\u6709\u6548\u7528\u6237ID\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06shm_perm.cuid\u548cshm_perm.uid\u8bbe\u7f6e\u4e3a\u8c03\u7528\u8fdb\u7a0b\u7684\u6709\u6548\u7528\u6237ID\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06shm_perm.cgid\u548cshm_perm.gid\u8bbe\u7f6e\u4e3a\u8c03\u7528\u8fdb\u7a0b\u7684\u6709\u6548\u7ec4ID\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06shm_perm.mode\u7684\u6700\u4f4e9\u4f4d\u8bbe\u7f6e\u4e3ashmflg\u53c2\u6570\u7684\u6700\u4f4e9\u4f4d\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06shm_segsz\u8bbe\u7f6e\u4e3asize\u3002")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("p",{parentName:"li"},"\u5c06shm_lpid\u3001shm_nattach\u3001shm_atime\u3001shm_dtime\u8bbe\u7f6e\u4e3a0\u3002"),(0,l.kt)("p",{parentName:"li"},"\u5c06shm_ctime\u8bbe\u7f6e\u4e3a\u5f53\u524d\u7684\u65f6\u95f4\u3002"))),(0,l.kt)("h4",{id:"shmat\u548cshmdt\u7cfb\u7edf\u8c03\u7528"},"shmat\u548cshmdt\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"\u5171\u4eab\u5185\u5b58\u88ab\u521b\u5efa/\u83b7\u53d6\u4e4b\u540e\uff0c\u6211\u4eec\u4e0d\u80fd\u7acb\u5373\u8bbf\u95ee\u5b83\uff0c\u800c\u662f\u9700\u8981\u5148\u5c06\u5b83\u5173\u8054\u5230\u8fdb\u7a0b\u7684\u5730\u5740\u7a7a\u95f4\u4e2d\u3002\u4f7f\u7528\u5b8c\u5171\u4eab\u5185\u5b58\u4e4b\u540e\uff0c\u6211\u4eec\u4e5f\u9700\u8981\u5c06\u5b83\u4ece\u8fdb\u7a0b\u5730\u5740\u7a7a\u95f4\u4e2d\u5206\u79bb\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"void*shmat(int shm_id,const void*shm_addr,int shmflg);\nint shmdt(const void*shm_addr);\n")),(0,l.kt)("p",null,"\u5176\u4e2d\uff0cshm_id\u53c2\u6570\u662f\u7531shmget\u8c03\u7528\u8fd4\u56de\u7684\u5171\u4eab\u5185\u5b58\u6807\u8bc6\u7b26\u3002shm_addr\u53c2\u6570\u6307\u5b9a\u5c06\u5171\u4eab\u5185\u5b58\u5173\u8054\u5230\u8fdb\u7a0b\u7684\u54ea\u5757\u5730\u5740\u7a7a\u95f4\uff0c\u6700\u7ec8\u7684\u6548\u679c\u8fd8\u53d7\u5230shmflg\u53c2\u6570\u7684\u53ef\u9009\u6807\u5fd7SHM_RND\u7684\u5f71\u54cd\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5982\u679cshm_addr\u4e3aNULL\uff0c\u5219\u88ab\u5173\u8054\u7684\u5730\u5740\u7531\u64cd\u4f5c\u7cfb\u7edf\u9009\u62e9\u3002\u8fd9\u662f\u63a8\u8350\u7684\u505a\u6cd5\uff0c\u4ee5\u786e\u4fdd\u4ee3\u7801\u7684\u53ef\u79fb\u690d\u6027\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679cshm_addr\u975e\u7a7a\uff0c\u5e76\u4e14SHM_RND\u6807\u5fd7\u672a\u88ab\u8bbe\u7f6e\uff0c\u5219\u5171\u4eab\u5185\u5b58\u88ab\u5173\u8054\u5230addr\u6307\u5b9a\u7684\u5730\u5740\u5904\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5982\u679cshm_addr\u975e\u7a7a\uff0c\u5e76\u4e14\u8bbe\u7f6e\u4e86SHM_RND\u6807\u5fd7\uff0c\u5219\u88ab\u5173\u8054\u7684\u5730\u5740\u662f","[shm_addr-(shm_addr%SHMLBA)]","\u3002SHMLBA\u7684\u542b\u4e49\u662f\u201c\u6bb5\u4f4e\u7aef\u8fb9\u754c\u5730\u5740\u500d\u6570\u201d\uff08Segment Low Boundary Address Multiple\uff09\uff0c\u5b83\u5fc5\u987b\u662f\u5185\u5b58\u9875\u9762\u5927\u5c0f\uff08PAGE_SIZE\uff09\u7684\u6574\u6570\u500d\u3002\u73b0\u5728\u7684Linux\u5185\u6838\u4e2d\uff0c\u5b83\u7b49\u4e8e\u4e00\u4e2a\u5185\u5b58\u9875\u5927\u5c0f\u3002SHM_RND\u7684\u542b\u4e49\u662f\u5706\u6574\uff08round\uff09\uff0c\u5373\u5c06\u5171\u4eab\u5185\u5b58\u88ab\u5173\u8054\u7684\u5730\u5740\u5411\u4e0b\u5706\u6574\u5230\u79bbshm_addr\u6700\u8fd1\u7684SHMLBA\u7684\u6574\u6570\u500d\u5730\u5740\u5904\u3002")),(0,l.kt)("h4",{id:"shmctl\u7cfb\u7edf\u8c03\u7528"},"shmctl\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"shmctl\u7cfb\u7edf\u8c03\u7528\u63a7\u5236\u5171\u4eab\u5185\u5b58\u7684\u67d0\u4e9b\u5c5e\u6027\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"int shmctl(int shm_id,int command,struct shmid_ds*buf);\n")),(0,l.kt)("p",null,"\u5176\u4e2d\uff0cshm_id\u53c2\u6570\u662f\u7531shmget\u8c03\u7528\u8fd4\u56de\u7684\u5171\u4eab\u5185\u5b58\u6807\u8bc6\u7b26\u3002command\u53c2\u6570\u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20210910165645296",src:n(26918).Z})),(0,l.kt)("p",null,"shmctl\u6210\u529f\u65f6\u7684\u8fd4\u56de\u503c\u53d6\u51b3\u4e8ecommand\u53c2\u6570\u3002shmctl\u5931\u8d25\u65f6\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("h4",{id:"\u5171\u4eab\u5185\u5b58\u7684posix\u65b9\u6cd5"},"\u3000\u5171\u4eab\u5185\u5b58\u7684POSIX\u65b9\u6cd5"),(0,l.kt)("p",null,"mmap\u51fd\u6570\u3002\u5229\u7528\u5b83\u7684MAP_ANONYMOUS\u6807\u5fd7\u6211\u4eec\u53ef\u4ee5\u5b9e\u73b0\u7236\u3001\u5b50\u8fdb\u7a0b\u4e4b\u95f4\u7684\u533f\u540d\u5185\u5b58\u5171\u4eab\u3002\u901a\u8fc7\u6253\u5f00\u540c\u4e00\u4e2a\u6587\u4ef6\uff0cmmap\u4e5f\u53ef\u4ee5\u5b9e\u73b0\u65e0\u5173\u8fdb\u7a0b\u4e4b\u95f4\u7684\u5185\u5b58\u5171\u4eab\u3002"),(0,l.kt)("p",null,"Linux\u63d0\u4f9b\u4e86\u53e6\u5916\u4e00\u79cd\u5229\u7528mmap\u5728\u65e0\u5173\u8fdb\u7a0b\u4e4b\u95f4\u5171\u4eab\u5185\u5b58\u7684\u65b9\u5f0f\u3002\u8fd9\u79cd\u65b9\u5f0f\u65e0\u987b\u4efb\u4f55\u6587\u4ef6\u7684\u652f\u6301\uff0c\u4f46\u5b83\u9700\u8981\u5148\u4f7f\u7528\u5982\u4e0b\u51fd\u6570\u6765\u521b\u5efa\u6216\u6253\u5f00\u4e00\u4e2aPOSIX\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include <sys/mman.h>\n#include <sys/stat.h>        /* For mode constants */\n#include <fcntl.h>           /* For O_* constants */\nint shm_open(const char *name, int oflag, mode_t mode);\n")),(0,l.kt)("p",null,"shm_open\u7684\u4f7f\u7528\u65b9\u6cd5\u4e0eopen\u7cfb\u7edf\u8c03\u7528\u5b8c\u5168\u76f8\u540c\u3002"),(0,l.kt)("p",null,"ame\u53c2\u6570\u6307\u5b9a\u8981\u521b\u5efa/\u6253\u5f00\u7684\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u3002\u4ece\u53ef\u79fb\u690d\u6027\u7684\u89d2\u5ea6\u8003\u8651\uff0c\u8be5\u53c2\u6570\u5e94\u8be5\u4f7f\u7528\u201c/somename\u201d\u7684\u683c\u5f0f\uff1a\u4ee5\u201c/\u201d\u5f00\u59cb\uff0c\u540e\u63a5\u591a\u4e2a\u5b57\u7b26\uff0c\u4e14\u8fd9\u4e9b\u5b57\u7b26\u90fd\u4e0d\u662f\u201c/\u201d\uff1b\u4ee5\u201c\uff3c0\u201d\u7ed3\u5c3e\uff0c\u957f\u5ea6\u4e0d\u8d85\u8fc7NAME_MAX\uff08\u901a\u5e38\u662f255\uff09\u3002"),(0,l.kt)("p",null,"oflag\u53c2\u6570\u6307\u5b9a\u521b\u5efa\u65b9\u5f0f\u3002\u5b83\u53ef\u4ee5\u662f\u4e0b\u5217\u6807\u5fd7\u4e2d\u7684\u4e00\u4e2a\u6216\u8005\u591a\u4e2a\u7684\u6309\u4f4d\u6216\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"O_RDONLY\u3002\u4ee5\u53ea\u8bfb\u65b9\u5f0f\u6253\u5f00\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u3002"),(0,l.kt)("li",{parentName:"ul"},"O_RDWR\u3002\u4ee5\u53ef\u8bfb\u3001\u53ef\u5199\u65b9\u5f0f\u6253\u5f00\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u3002"),(0,l.kt)("li",{parentName:"ul"},"O_CREAT\u3002\u5982\u679c\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u4e0d\u5b58\u5728\uff0c\u5219\u521b\u5efa\u4e4b\u3002\u6b64\u65f6mode\u53c2\u6570\u7684\u6700\u4f4e9\u4f4d\u5c06\u6307\u5b9a\u8be5\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u7684\u8bbf\u95ee\u6743\u9650\u3002\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u88ab\u521b\u5efa\u7684\u65f6\u5019\uff0c\u5176\u521d\u59cb\u957f\u5ea6\u4e3a0\u3002"),(0,l.kt)("li",{parentName:"ul"},"O_EXCL\u3002\u548cO_CREAT\u4e00\u8d77\u4f7f\u7528\uff0c\u5982\u679c\u7531name\u6307\u5b9a\u7684\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u5df2\u7ecf\u5b58\u5728\uff0c\u5219shm_open\u8c03\u7528\u8fd4\u56de\u9519\u8bef\uff0c\u5426\u5219\u5c31\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u3002"),(0,l.kt)("li",{parentName:"ul"},"O_TRUNC\u3002\u5982\u679c\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u5df2\u7ecf\u5b58\u5728\uff0c\u5219\u628a\u5b83\u622a\u65ad\uff0c\u4f7f\u5176\u957f\u5ea6\u4e3a0\u3002")),(0,l.kt)("p",null,"shm_open\u8c03\u7528\u6210\u529f\u65f6\u8fd4\u56de\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u3002\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ef\u7528\u4e8e\u540e\u7eed\u7684mmap\u8c03\u7528\uff0c\u4ece\u800c\u5c06\u5171\u4eab\u5185\u5b58\u5173\u8054\u5230\u8c03\u7528\u8fdb\u7a0b\u3002shm_open\u5931\u8d25\u65f6\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("p",null,"\u548c\u6253\u5f00\u7684\u6587\u4ef6\u6700\u540e\u9700\u8981\u5173\u95ed\u4e00\u6837\uff0c\u7531shm_open\u521b\u5efa\u7684\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u4f7f\u7528\u5b8c\u4e4b\u540e\u4e5f\u9700\u8981\u88ab\u5220\u9664\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"int shm_unlink(const char *name);\n")),(0,l.kt)("p",null,"\u8be5\u51fd\u6570\u5c06name\u53c2\u6570\u6307\u5b9a\u7684\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u6807\u8bb0\u4e3a\u7b49\u5f85\u5220\u9664\u3002\u5f53\u6240\u6709\u4f7f\u7528\u8be5\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u7684\u8fdb\u7a0b\u90fd\u4f7f\u7528ummap\u5c06\u5b83\u4ece\u8fdb\u7a0b\u4e2d\u5206\u79bb\u4e4b\u540e\uff0c\u7cfb\u7edf\u5c06\u9500\u6bc1\u8fd9\u4e2a\u5171\u4eab\u5185\u5b58\u5bf9\u8c61\u6240\u5360\u636e\u7684\u8d44\u6e90\u3002"),(0,l.kt)("p",null,"\u5982\u679c\u4ee3\u7801\u4e2d\u4f7f\u7528\u4e86\u4e0a\u8ff0POSIX\u5171\u4eab\u5185\u5b58\u51fd\u6570\uff0c\u5219\u7f16\u8bd1\u7684\u65f6\u5019\u9700\u8981\u6307\u5b9a\u94fe\u63a5\u9009\u9879-lrt\u3002"),(0,l.kt)("h4",{id:"\u5171\u4eab\u5185\u5b58\u5b9e\u4f8b"},"\u5171\u4eab\u5185\u5b58\u5b9e\u4f8b"),(0,l.kt)("p",null,"\u4f7f\u7528\u5171\u4eab\u5185\u5b58\u7684\u804a\u5929\u5ba4\u670d\u52a1\u5668\u7a0b\u5e8f"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"")),(0,l.kt)("h3",{id:"\u6d88\u606f\u961f\u5217"},"\u6d88\u606f\u961f\u5217"),(0,l.kt)("p",null,"\u6d88\u606f\u961f\u5217\u662f\u5728\u4e24\u4e2a\u8fdb\u7a0b\u4e4b\u95f4\u4f20\u9012\u4e8c\u8fdb\u5236\u5757\u6570\u636e\u7684\u4e00\u79cd\u7b80\u5355\u6709\u6548\u7684\u65b9\u5f0f\u3002\u6bcf\u4e2a\u6570\u636e\u5757\u90fd\u6709\u4e00\u4e2a\u7279\u5b9a\u7684\u7c7b\u578b\uff0c\u63a5\u6536\u65b9\u53ef\u4ee5\u6839\u636e\u7c7b\u578b\u6765\u6709\u9009\u62e9\u5730\u63a5\u6536\u6570\u636e\uff0c\u800c\u4e0d\u4e00\u5b9a\u50cf\u7ba1\u9053\u548c\u547d\u540d\u7ba1\u9053\u90a3\u6837\u5fc5\u987b\u4ee5\u5148\u8fdb\u5148\u51fa\u7684\u65b9\u5f0f\u63a5\u6536\u6570\u636e\u3002"),(0,l.kt)("p",null,"Linux\u6d88\u606f\u961f\u5217\u7684API\u90fd\u5b9a\u4e49\u5728sys/msg.h\u5934\u6587\u4ef6\u4e2d\uff0c\u5305\u62ec4\u4e2a\u7cfb\u7edf\u8c03\u7528\uff1amsgget\u3001msgsnd\u3001msgrcv\u548cmsgctl\u3002"),(0,l.kt)("h4",{id:"msgget\u7cfb\u7edf\u8c03\u7528"},"msgget\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"msgget\u7cfb\u7edf\u8c03\u7528\u521b\u5efa\u4e00\u4e2a\u6d88\u606f\u961f\u5217\uff0c\u6216\u8005\u83b7\u53d6\u4e00\u4e2a\u5df2\u6709\u7684\u6d88\u606f\u961f\u5217\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre"},"#include <sys/msg.h>\nint msgget(key_t key,int msgflg);\n")),(0,l.kt)("p",null,"\u548csemget\u7cfb\u7edf\u8c03\u7528\u4e00\u6837\uff0ckey\u53c2\u6570\u662f\u4e00\u4e2a\u952e\u503c\uff0c\u7528\u6765\u6807\u8bc6\u4e00\u4e2a\u5168\u5c40\u552f\u4e00\u7684\u6d88\u606f\u961f\u5217\u3002\nmsgflg\u53c2\u6570\u7684\u4f7f\u7528\u548c\u542b\u4e49\u4e0esemget\u7cfb\u7edf\u8c03\u7528\u7684sem_flags\u53c2\u6570\u76f8\u540c\u3002\nmsgget\u6210\u529f\u65f6\u8fd4\u56de\u4e00\u4e2a\u6b63\u6574\u6570\u503c\uff0c\u5b83\u662f\u6d88\u606f\u961f\u5217\u7684\u6807\u8bc6\u7b26\u3002msgget\u5931\u8d25\u65f6\u8fd4\u56de-1\uff0c\u5e76\u8bbe\u7f6eerrno\u3002\n\u5982\u679cmsgget\u7528\u4e8e\u521b\u5efa\u6d88\u606f\u961f\u5217\uff0c\u5219\u4e0e\u4e4b\u5173\u8054\u7684\u5185\u6838\u6570\u636e\u7ed3\u6784msqid_ds\u5c06\u88ab\u521b\u5efa\u5e76\u521d\u59cb\u5316\u3002\nmsqid_ds\u7ed3\u6784\u4f53\u7684\u5b9a\u4e49\u5982\u4e0b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"struct msqid_ds\n{\nstruct ipc_perm msg_perm;/*\u6d88\u606f\u961f\u5217\u7684\u64cd\u4f5c\u6743\u9650*/\ntime_t msg_stime;/*\u6700\u540e\u4e00\u6b21\u8c03\u7528msgsnd\u7684\u65f6\u95f4*/\ntime_t msg_rtime;/*\u6700\u540e\u4e00\u6b21\u8c03\u7528msgrcv\u7684\u65f6\u95f4*/\ntime_t msg_ctime;/*\u6700\u540e\u4e00\u6b21\u88ab\u4fee\u6539\u7684\u65f6\u95f4*/\nunsigned long__msg_cbytes;/*\u6d88\u606f\u961f\u5217\u4e2d\u5df2\u6709\u7684\u5b57\u8282\u6570*/\nmsgqnum_t msg_qnum;/*\u6d88\u606f\u961f\u5217\u4e2d\u5df2\u6709\u7684\u6d88\u606f\u6570*/\nmsglen_t msg_qbytes;/*\u6d88\u606f\u961f\u5217\u5141\u8bb8\u7684\u6700\u5927\u5b57\u8282\u6570*/\npid_t msg_lspid;/*\u6700\u540e\u6267\u884cmsgsnd\u7684\u8fdb\u7a0b\u7684PID*/\npid_t msg_lrpid;/*\u6700\u540e\u6267\u884cmsgrcv\u7684\u8fdb\u7a0b\u7684PID*/\n}\n")),(0,l.kt)("h4",{id:"msgsnd\u7cfb\u7edf\u8c03\u7528"},"msgsnd\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"msgsnd\u7cfb\u7edf\u8c03\u7528\u628a\u4e00\u6761\u6d88\u606f\u6dfb\u52a0\u5230\u6d88\u606f\u961f\u5217\u4e2d\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"int msgsnd(int msqid,const void*msg_ptr,size_t msg_sz,int msgflg);\n")),(0,l.kt)("p",null,"msqid\u53c2\u6570\u662f\u7531msgget\u8c03\u7528\u8fd4\u56de\u7684\u6d88\u606f\u961f\u5217\u6807\u8bc6\u7b26\u3002\nmsg_ptr\u53c2\u6570\u6307\u5411\u4e00\u4e2a\u51c6\u5907\u53d1\u9001\u7684\u6d88\u606f\uff0c\u6d88\u606f\u5fc5\u987b\u88ab\u5b9a\u4e49\u4e3a\u5982\u4e0b\u7c7b\u578b\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"struct msgbuf\n{\nlong mtype;/*\u6d88\u606f\u7c7b\u578b*/\nchar mtext[512];/*\u6d88\u606f\u6570\u636e*/\n};\n")),(0,l.kt)("p",null,"\u5176\u4e2d\uff0cmtype\u6210\u5458\u6307\u5b9a\u6d88\u606f\u7684\u7c7b\u578b\uff0c\u5b83\u5fc5\u987b\u662f\u4e00\u4e2a\u6b63\u6574\u6570\u3002mtext\u662f\u6d88\u606f\u6570\u636e\u3002msg_sz\u53c2\u6570\n\u662f\u6d88\u606f\u7684\u6570\u636e\u90e8\u5206\uff08mtext\uff09\u7684\u957f\u5ea6\u3002\u8fd9\u4e2a\u957f\u5ea6\u53ef\u4ee5\u4e3a0\uff0c\u8868\u793a\u6ca1\u6709\u6d88\u606f\u6570\u636e\u3002\nmsgflg\u53c2\u6570\u63a7\u5236msgsnd\u7684\u884c\u4e3a\u3002\u5b83\u901a\u5e38\u4ec5\u652f\u6301IPC_NOWAIT\u6807\u5fd7\uff0c\u5373\u4ee5\u975e\u963b\u585e\u7684\u65b9\u5f0f\u53d1\u9001\n\u6d88\u606f\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u53d1\u9001\u6d88\u606f\u65f6\u5982\u679c\u6d88\u606f\u961f\u5217\u6ee1\u4e86\uff0c\u5219msgsnd\u5c06\u963b\u585e\u3002\u82e5IPC_NOWAIT\u6807\u5fd7\u88ab\n\u6307\u5b9a\uff0c\u5219msgsnd\u5c06\u7acb\u5373\u8fd4\u56de\u5e76\u8bbe\u7f6eerrno\u4e3aEAGAIN\u3002\n\u5904\u4e8e\u963b\u585e\u72b6\u6001\u7684msgsnd\u8c03\u7528\u53ef\u80fd\u88ab\u5982\u4e0b\u4e24\u79cd\u5f02\u5e38\u60c5\u51b5\u6240\u4e2d\u65ad\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u6d88\u606f\u961f\u5217\u88ab\u79fb\u9664\u3002\u6b64\u65f6msgsnd\u8c03\u7528\u5c06\u7acb\u5373\u8fd4\u56de\u5e76\u8bbe\u7f6eerrno\u4e3aEIDRM\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u7a0b\u5e8f\u63a5\u6536\u5230\u4fe1\u53f7\u3002\u6b64\u65f6msgsnd\u8c03\u7528\u5c06\u7acb\u5373\u8fd4\u56de\u5e76\u8bbe\u7f6eerrno\u4e3aEINTR\u3002")),(0,l.kt)("p",null,"msgsnd\u6210\u529f\u65f6\u8fd4\u56de0\uff0c\u5931\u8d25\u5219\u8fd4\u56de-1\u5e76\u8bbe\u7f6eerrno\u3002msgsnd\u6210\u529f\u65f6\u5c06\u4fee\u6539\u5185\u6838\u6570\u636e\u7ed3\u6784"),(0,l.kt)("p",null,"msqid_ds\u7684\u90e8\u5206\u5b57\u6bb5\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5c06msg_qnum\u52a01\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06msg_lspid\u8bbe\u7f6e\u4e3a\u8c03\u7528\u8fdb\u7a0b\u7684PID\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06msg_stime\u8bbe\u7f6e\u4e3a\u5f53\u524d\u7684\u65f6\u95f4\u3002")),(0,l.kt)("h4",{id:"msgrcv\u7cfb\u7edf\u8c03\u7528"},"msgrcv\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"msgrcv\u7cfb\u7edf\u8c03\u7528\u4ece\u6d88\u606f\u961f\u5217\u4e2d\u83b7\u53d6\u6d88\u606f\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"int msgrcv(int msqid,void*msg_ptr,size_t msg_sz,long int msgtype,int msgflg);\n")),(0,l.kt)("p",null,"msqid\u53c2\u6570\u662f\u7531msgget\u8c03\u7528\u8fd4\u56de\u7684\u6d88\u606f\u961f\u5217\u6807\u8bc6\u7b26\u3002\nmsg_ptr\u53c2\u6570\u7528\u4e8e\u5b58\u50a8\u63a5\u6536\u7684\u6d88\u606f\uff0cmsg_sz\u53c2\u6570\u6307\u7684\u662f\u6d88\u606f\u6570\u636e\u90e8\u5206\u7684\u957f\u5ea6\u3002\nmsgtype\u53c2\u6570\u6307\u5b9a\u63a5\u6536\u4f55\u79cd\u7c7b\u578b\u7684\u6d88\u606f\u3002\u6211\u4eec\u53ef\u4ee5\u4f7f\u7528\u5982\u4e0b\u51e0\u79cd\u65b9\u5f0f\u6765\u6307\u5b9a\u6d88\u606f\u7c7b\u578b\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"msgtype\u7b49\u4e8e0\u3002\u8bfb\u53d6\u6d88\u606f\u961f\u5217\u4e2d\u7684\u7b2c\u4e00\u4e2a\u6d88\u606f\u3002"),(0,l.kt)("li",{parentName:"ul"},"msgtype\u5927\u4e8e0\u3002\u8bfb\u53d6\u6d88\u606f\u961f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u7c7b\u578b\u4e3amsgtype\u7684\u6d88\u606f\uff08\u9664\u975e\u6307\u5b9a\u4e86\u6807\u5fd7\nMSG_EXCEPT\uff0c\u89c1\u540e\u6587\uff09\u3002"),(0,l.kt)("li",{parentName:"ul"},"msgtype\u5c0f\u4e8e0\u3002\u8bfb\u53d6\u6d88\u606f\u961f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u7c7b\u578b\u503c\u6bd4msgtype\u7684\u7edd\u5bf9\u503c\u5c0f\u7684\u6d88\u606f\u3002")),(0,l.kt)("p",null,"\u53c2\u6570msgflg\u63a7\u5236msgrcv\u51fd\u6570\u7684\u884c\u4e3a\u3002\u5b83\u53ef\u4ee5\u662f\u5982\u4e0b\u4e00\u4e9b\u6807\u5fd7\u7684\u6309\u4f4d\u6216\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"IPC_NOWAIT\u3002\u5982\u679c\u6d88\u606f\u961f\u5217\u4e2d\u6ca1\u6709\u6d88\u606f\uff0c\u5219msgrcv\u8c03\u7528\u7acb\u5373\u8fd4\u56de\u5e76\u8bbe\u7f6eerrno\u4e3a\nENOMSG\u3002"),(0,l.kt)("li",{parentName:"ul"},"MSG_EXCEPT\u3002\u5982\u679cmsgtype\u5927\u4e8e0\uff0c\u5219\u63a5\u6536\u6d88\u606f\u961f\u5217\u4e2d\u7b2c\u4e00\u4e2a\u975emsgtype\u7c7b\u578b\u7684\u6d88\u606f\u3002"),(0,l.kt)("li",{parentName:"ul"},"MSG_NOERROR\u3002\u5982\u679c\u6d88\u606f\u6570\u636e\u90e8\u5206\u7684\u957f\u5ea6\u8d85\u8fc7\u4e86msg_sz\uff0c\u5c31\u5c06\u5b83\u622a\u65ad\u3002\n\u5904\u4e8e\u963b\u585e\u72b6\u6001\u7684msgrcv\u8c03\u7528\u8fd8\u53ef\u80fd\u88ab\u5982\u4e0b\u4e24\u79cd\u5f02\u5e38\u60c5\u51b5\u6240\u4e2d\u65ad\uff1a"),(0,l.kt)("li",{parentName:"ul"},"\u6d88\u606f\u961f\u5217\u88ab\u79fb\u9664\u3002\u6b64\u65f6msgrcv\u8c03\u7528\u5c06\u7acb\u5373\u8fd4\u56de\u5e76\u8bbe\u7f6eerrno\u4e3aEIDRM\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u7a0b\u5e8f\u63a5\u6536\u5230\u4fe1\u53f7\u3002\u6b64\u65f6msgrcv\u8c03\u7528\u5c06\u7acb\u5373\u8fd4\u56de\u5e76\u8bbe\u7f6eerrno\u4e3aEINTR\u3002")),(0,l.kt)("p",null,"msgrcv\u6210\u529f\u65f6\u8fd4\u56de0\uff0c\u5931\u8d25\u5219\u8fd4\u56de-1\u5e76\u8bbe\u7f6eerrno\u3002msgrcv\u6210\u529f\u65f6\u5c06\u4fee\u6539\u5185\u6838\u6570\u636e\u7ed3\u6784\nmsqid_ds\u7684\u90e8\u5206\u5b57\u6bb5\uff0c\u5982\u4e0b\u6240\u793a\uff1a"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"\u5c06msg_qnum\u51cf1\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06msg_lrpid\u8bbe\u7f6e\u4e3a\u8c03\u7528\u8fdb\u7a0b\u7684PID\u3002"),(0,l.kt)("li",{parentName:"ul"},"\u5c06msg_rtime\u8bbe\u7f6e\u4e3a\u5f53\u524d\u7684\u65f6\u95f4\u3002")),(0,l.kt)("h4",{id:"msgctl\u7cfb\u7edf\u8c03\u7528"},"msgctl\u7cfb\u7edf\u8c03\u7528"),(0,l.kt)("p",null,"msgctl\u7cfb\u7edf\u8c03\u7528\u63a7\u5236\u6d88\u606f\u961f\u5217\u7684\u67d0\u4e9b\u5c5e\u6027\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"int msgctl(int msqid,int command,struct msqid_ds*buf);\n")),(0,l.kt)("p",null,"msqid\u53c2\u6570\u662f\u7531msgget\u8c03\u7528\u8fd4\u56de\u7684\u5171\u4eab\u5185\u5b58\u6807\u8bc6\u7b26\u3002command\u53c2\u6570\u6307\u5b9a\u8981\u6267\u884c\u7684\u547d\u4ee4\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20210910122808667",src:n(32895).Z})),(0,l.kt)("p",null,"msgctl\u6210\u529f\u65f6\u7684\u8fd4\u56de\u503c\u53d6\u51b3\u4e8ecommand\u53c2\u6570\uff0c\u5982\u886813-4\u6240\u793a\u3002msgctl\u51fd\u6570\u5931\u8d25\u65f6\u8fd4\u56de-1\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("h3",{id:"ipc\u547d\u4ee4"},"IPC\u547d\u4ee4"),(0,l.kt)("p",null,"\u4e0a\u8ff03\u79cdSystem V IPC\u8fdb\u7a0b\u95f4\u901a\u4fe1\u65b9\u5f0f\u90fd\u4f7f\u7528\u4e00\u4e2a\u5168\u5c40\u552f\u4e00\u7684\u952e\u503c\uff08key\uff09\u6765\u63cf\u8ff0\u4e00\u4e2a\u5171\u4eab\u8d44\u6e90\u3002\u5f53\u7a0b\u5e8f\u8c03\u7528semget\u3001shmget\u6216\u8005msgget\u65f6\uff0c\u5c31\u521b\u5efa\u4e86\u8fd9\u4e9b\u5171\u4eab\u8d44\u6e90\u7684\u4e00\u4e2a\u5b9e\u4f8b\u3002"),(0,l.kt)("p",null,"Linux\u63d0\u4f9b\u4e86",(0,l.kt)("inlineCode",{parentName:"p"},"ipcs"),"\u547d\u4ee4\uff0c\u4ee5\u89c2\u5bdf\u5f53\u524d\u7cfb\u7edf\u4e0a\u62e5\u6709\u54ea\u4e9b\u5171\u4eab\u8d44\u6e90\u5b9e\u4f8b\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"},"$sudo ipcs\n------Shared Memory Segments--------\nkey shmid owner perms bytes nattch status\n------Semaphore Arrays--------\nkey semid owner perms nsems\n0x00000000 196608 apache 600 1\n0x00000000 229377 apache 600 1\n0x00000000 262146 apache 600 1\n0x00000000 294915 apache 600 1\n0x00000000 327684 apache 600 1\n0x00000000 360453 apache 600 1\n0x00000000 393222 apache 600 1\n------Message Queues--------\nkey msqid owner perms used-bytes message\n")),(0,l.kt)("p",null,"\u53ef\u4ee5\u4f7f\u7528ipcrm\u547d\u4ee4\u6765\u5220\u9664\u9057\u7559\u5728\u7cfb\u7edf\u4e2d\u7684\u5171\u4eab\u8d44\u6e90\u3002"),(0,l.kt)("h3",{id:"\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26"},"\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26"),(0,l.kt)("p",null,"\u7531\u4e8efork\u8c03\u7528\u4e4b\u540e\uff0c\u7236\u8fdb\u7a0b\u4e2d\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u5728\u5b50\u8fdb\u7a0b\u4e2d\u4ecd\u7136\u4fdd\u6301\u6253\u5f00\uff0c\u6240\u4ee5\u6587\u4ef6\u63cf\u8ff0\u7b26\u53ef\u4ee5\u5f88\u65b9\u4fbf\u5730\u4ece\u7236\u8fdb\u7a0b\u4f20\u9012\u5230\u5b50\u8fdb\u7a0b\u3002"),(0,l.kt)("p",null,"\u9700\u8981\u6ce8\u610f\u7684\u662f\uff0c\u4f20\u9012\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u5e76\u4e0d\u662f\u4f20\u9012\u4e00\u4e2a\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u503c\uff0c\u800c\u662f\u8981\u5728\u63a5\u6536\u8fdb\u7a0b\u4e2d\u521b\u5efa\u4e00\u4e2a\u65b0\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u5e76\u4e14\u8be5\u6587\u4ef6\u63cf\u8ff0\u7b26\u548c\u53d1\u9001\u8fdb\u7a0b\u4e2d\u88ab\u4f20\u9012\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\u6307\u5411\u5185\u6838\u4e2d\u76f8\u540c\u7684\u6587\u4ef6\u8868\u9879\u3002"),(0,l.kt)("p",null,"\u5982\u4f55\u5728\u4e24\u4e2a\u4e0d\u76f8\u5e72\u7684\u8fdb\u7a0b\u4e4b\u95f4\u4f20\u9012\u6587\u4ef6\u63cf\u8ff0\u7b26\u5462\uff1f"),(0,l.kt)("p",null,"\u5728Linux\u4e0b\uff0c\u6211\u4eec\u53ef\u4ee5\u5229\u7528UNIX\u57dfsocket\u5728\u8fdb\u7a0b\u95f4\u4f20\u9012\u7279\u6b8a\u7684\u8f85\u52a9\u6570\u636e\uff0c\u4ee5\u5b9e\u73b0\u6587\u4ef6\u63cf\u8ff0\u7b26\u7684\u4f20\u9012"))}o.isMDXComponent=!0},32895:function(e,t,n){t.Z=n.p+"assets/images/image-20210910122808667-e9aeb13f24dcc181d82ef5c6d022f445.png"},38491:function(e,t,n){t.Z=n.p+"assets/images/image-20210910153709109-d3e2b4c297ec4b63b53fcf57ac4bb61c.png"},7283:function(e,t,n){t.Z=n.p+"assets/images/image-20210910154057147-0f21803cb91784cf4ac90ada051d29b4.png"},41962:function(e,t,n){t.Z=n.p+"assets/images/image-20210910164111640-c3cb32dedbf39a34440262dde93c8972.png"},92032:function(e,t,n){t.Z=n.p+"assets/images/image-20210910165101598-ed9382b92ab488c091ca444557e37e00.png"},26918:function(e,t,n){t.Z=n.p+"assets/images/image-20210910165645296-9cd5fdb34f59bdbd52bb6751fb66abd0.png"}}]);