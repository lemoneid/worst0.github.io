(self.webpackChunkwiki=self.webpackChunkwiki||[]).push([[6448],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return m},kt:function(){return d}});var r=t(67294);function l(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function a(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){l(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,r,l=function(e,n){if(null==e)return{};var t,r,l={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(l[t]=e[t]);return l}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var u=r.createContext({}),p=function(e){var n=r.useContext(u),t=n;return e&&(t="function"==typeof e?e(n):a(a({},n),e)),t},m=function(e){var n=p(e.components);return r.createElement(u.Provider,{value:n},e.children)},s={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},c=r.forwardRef((function(e,n){var t=e.components,l=e.mdxType,i=e.originalType,u=e.parentName,m=o(e,["components","mdxType","originalType","parentName"]),c=p(t),d=l,k=c["".concat(u,".").concat(d)]||c[d]||s[d]||i;return t?r.createElement(k,a(a({ref:n},m),{},{components:t})):r.createElement(k,a({ref:n},m))}));function d(e,n){var t=arguments,l=n&&n.mdxType;if("string"==typeof e||l){var i=t.length,a=new Array(i);a[0]=c;var o={};for(var u in n)hasOwnProperty.call(n,u)&&(o[u]=n[u]);o.originalType=e,o.mdxType="string"==typeof e?e:l,a[1]=o;for(var p=2;p<i;p++)a[p]=t[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"},79841:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return o},metadata:function(){return u},toc:function(){return p},default:function(){return s}});var r=t(22122),l=t(19756),i=(t(67294),t(3905)),a=["components"],o={},u={unversionedId:"Project/\u9762\u8bd5",id:"Project/\u9762\u8bd5",isDocsHomePage:!1,title:"\u9762\u8bd5",description:"\u9762\u8bd5\u9898",source:"@site/docs/13.Project/\u9762\u8bd5.md",sourceDirName:"13.Project",slug:"/Project/\u9762\u8bd5",permalink:"/Project/\u9762\u8bd5",editUrl:"https://github.com/worst0/wiki_note/edit/main/docs/13.Project/\u9762\u8bd5.md",version:"current",frontMatter:{}},p=[{value:"\u9762\u8bd5\u9898",id:"\u9762\u8bd5\u9898",children:[]}],m={toc:p};function s(e){var n=e.components,t=(0,l.Z)(e,a);return(0,i.kt)("wrapper",(0,r.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)("h3",{id:"\u9762\u8bd5\u9898"},"\u9762\u8bd5\u9898"),(0,i.kt)("p",null,"\u5305\u62ec\u9879\u76ee\u4ecb\u7ecd\uff0c\u7ebf\u7a0b\u6c60\u76f8\u5173\uff0c\u5e76\u53d1\u6a21\u578b\u76f8\u5173\uff0cHTTP\u62a5\u6587\u89e3\u6790\u76f8\u5173\uff0c\u5b9a\u65f6\u5668\u76f8\u5173\uff0c\u65e5\u5fd7\u76f8\u5173\uff0c\u538b\u6d4b\u76f8\u5173\uff0c\u7efc\u5408\u80fd\u529b\u7b49\u3002"),(0,i.kt)("h4",{id:"\u9879\u76ee\u4ecb\u7ecd"},(0,i.kt)("strong",{parentName:"h4"},"\u9879\u76ee\u4ecb\u7ecd")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e3a\u4ec0\u4e48\u8981\u505a\u8fd9\u6837\u4e00\u4e2a\u9879\u76ee\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u4ecb\u7ecd\u4e0b\u4f60\u7684\u9879\u76ee")),(0,i.kt)("h4",{id:"\u7ebf\u7a0b\u6c60\u76f8\u5173"},(0,i.kt)("strong",{parentName:"h4"},"\u7ebf\u7a0b\u6c60\u76f8\u5173")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u624b\u5199\u7ebf\u7a0b\u6c60"),(0,i.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u7684\u540c\u6b65\u673a\u5236\u6709\u54ea\u4e9b\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u7ebf\u7a0b\u6c60\u4e2d\u7684\u5de5\u4f5c\u7ebf\u7a0b\u662f\u4e00\u76f4\u7b49\u5f85\u5417\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u4f60\u7684\u7ebf\u7a0b\u6c60\u5de5\u4f5c\u7ebf\u7a0b\u5904\u7406\u5b8c\u4e00\u4e2a\u4efb\u52a1\u540e\u7684\u72b6\u6001\u662f\u4ec0\u4e48\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u540c\u65f61000\u4e2a\u5ba2\u6237\u7aef\u8fdb\u884c\u8bbf\u95ee\u8bf7\u6c42\uff0c\u7ebf\u7a0b\u6570\u4e0d\u591a\uff0c\u600e\u4e48\u80fd\u53ca\u65f6\u54cd\u5e94\u5904\u7406\u6bcf\u4e00\u4e2a\u5462\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u5982\u679c\u4e00\u4e2a\u5ba2\u6237\u8bf7\u6c42\u9700\u8981\u5360\u7528\u7ebf\u7a0b\u5f88\u4e45\u7684\u65f6\u95f4\uff0c\u4f1a\u4e0d\u4f1a\u5f71\u54cd\u63a5\u4e0b\u6765\u7684\u5ba2\u6237\u8bf7\u6c42\u5462\uff0c\u6709\u4ec0\u4e48\u597d\u7684\u7b56\u7565\u5462?")),(0,i.kt)("h4",{id:"\u5e76\u53d1\u6a21\u578b\u76f8\u5173"},(0,i.kt)("strong",{parentName:"h4"},"\u5e76\u53d1\u6a21\u578b\u76f8\u5173")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7b80\u5355\u8bf4\u4e00\u4e0b\u670d\u52a1\u5668\u4f7f\u7528\u7684\u5e76\u53d1\u6a21\u578b\uff1f"),(0,i.kt)("li",{parentName:"ul"},"reactor\u3001proactor\u3001\u4e3b\u4ecereactor\u6a21\u578b\u7684\u533a\u522b\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u4f60\u7528\u4e86epoll\uff0c\u8bf4\u4e00\u4e0b\u4e3a\u4ec0\u4e48\u7528epoll\uff0c\u8fd8\u6709\u5176\u4ed6\u590d\u7528\u65b9\u5f0f\u5417\uff1f\u533a\u522b\u662f\u4ec0\u4e48\uff1f")),(0,i.kt)("h4",{id:"http\u62a5\u6587\u89e3\u6790\u76f8\u5173"},(0,i.kt)("strong",{parentName:"h4"},"HTTP\u62a5\u6587\u89e3\u6790\u76f8\u5173")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7528\u4e86\u72b6\u6001\u673a\u554a\uff0c\u4e3a\u4ec0\u4e48\u8981\u7528\u72b6\u6001\u673a\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u72b6\u6001\u673a\u7684\u8f6c\u79fb\u56fe\u753b\u4e00\u4e0b"),(0,i.kt)("li",{parentName:"ul"},"https\u534f\u8bae\u4e3a\u4ec0\u4e48\u5b89\u5168\uff1f"),(0,i.kt)("li",{parentName:"ul"},"https\u7684ssl\u8fde\u63a5\u8fc7\u7a0b"),(0,i.kt)("li",{parentName:"ul"},"GET\u548cPOST\u7684\u533a\u522b")),(0,i.kt)("h4",{id:"\u6570\u636e\u5e93\u767b\u5f55\u6ce8\u518c\u76f8\u5173"},(0,i.kt)("strong",{parentName:"h4"},"\u6570\u636e\u5e93\u767b\u5f55\u6ce8\u518c\u76f8\u5173")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u767b\u5f55\u8bf4\u4e00\u4e0b\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u4f60\u8fd9\u4e2a\u4fdd\u5b58\u72b6\u6001\u4e86\u5417\uff1f\u5982\u679c\u8981\u4fdd\u5b58\uff0c\u4f60\u4f1a\u600e\u4e48\u505a\uff1f\uff08cookie\u548csession\uff09"),(0,i.kt)("li",{parentName:"ul"},"\u767b\u5f55\u4e2d\u7684\u7528\u6237\u540d\u548c\u5bc6\u7801\u4f60\u662fload\u5230\u672c\u5730\uff0c\u7136\u540e\u4f7f\u7528map\u5339\u914d\u7684\uff0c\u5982\u679c\u670910\u4ebf\u6570\u636e\uff0c\u5373\u4f7fload\u5230\u672c\u5730\u540ehash\uff0c\u4e5f\u662f\u5f88\u8017\u65f6\u7684\uff0c\u4f60\u8981\u600e\u4e48\u4f18\u5316\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u7528\u7684mysql\u554a\uff0credis\u4e86\u89e3\u5417\uff1f\u7528\u8fc7\u5417\uff1f")),(0,i.kt)("h4",{id:"\u5b9a\u65f6\u5668\u76f8\u5173"},(0,i.kt)("strong",{parentName:"h4"},"\u5b9a\u65f6\u5668\u76f8\u5173")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4e3a\u4ec0\u4e48\u8981\u7528\u5b9a\u65f6\u5668\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u8bf4\u4e00\u4e0b\u5b9a\u65f6\u5668\u7684\u5de5\u4f5c\u539f\u7406"),(0,i.kt)("li",{parentName:"ul"},"\u53cc\u5411\u94fe\u8868\u554a\uff0c\u5220\u9664\u548c\u6dfb\u52a0\u7684\u65f6\u95f4\u590d\u6742\u5ea6\u8bf4\u4e00\u4e0b\uff1f\u8fd8\u53ef\u4ee5\u4f18\u5316\u5417\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u6700\u5c0f\u5806\u4f18\u5316\uff1f\u8bf4\u4e00\u4e0b\u65f6\u95f4\u590d\u6742\u5ea6\u548c\u5de5\u4f5c\u539f\u7406")),(0,i.kt)("h4",{id:"\u65e5\u5fd7\u76f8\u5173"},(0,i.kt)("strong",{parentName:"h4"},"\u65e5\u5fd7\u76f8\u5173")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u8bf4\u4e0b\u4f60\u7684\u65e5\u5fd7\u7cfb\u7edf\u7684\u8fd0\u884c\u673a\u5236\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u4e3a\u4ec0\u4e48\u8981\u5f02\u6b65\uff1f\u548c\u540c\u6b65\u7684\u533a\u522b\u662f\u4ec0\u4e48\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u73b0\u5728\u4f60\u8981\u76d1\u63a7\u4e00\u53f0\u670d\u52a1\u5668\u7684\u72b6\u6001\uff0c\u8f93\u51fa\u76d1\u63a7\u65e5\u5fd7\uff0c\u8bf7\u95ee\u5982\u4f55\u5c06\u8be5\u65e5\u5fd7\u5206\u53d1\u5230\u4e0d\u540c\u7684\u673a\u5668\u4e0a\uff1f\uff08\u6d88\u606f\u961f\u5217\uff09")),(0,i.kt)("h4",{id:"\u538b\u6d4b\u76f8\u5173"},(0,i.kt)("strong",{parentName:"h4"},"\u538b\u6d4b\u76f8\u5173")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u670d\u52a1\u5668\u5e76\u53d1\u91cf\u6d4b\u8bd5\u8fc7\u5417\uff1f\u600e\u4e48\u6d4b\u8bd5\u7684\uff1f"),(0,i.kt)("li",{parentName:"ul"},"webbench\u662f\u4ec0\u4e48\uff1f\u4ecb\u7ecd\u4e00\u4e0b\u539f\u7406"),(0,i.kt)("li",{parentName:"ul"},"\u6d4b\u8bd5\u7684\u65f6\u5019\u6709\u6ca1\u6709\u9047\u5230\u95ee\u9898\uff1f")),(0,i.kt)("h4",{id:"\u7efc\u5408\u80fd\u529b"},(0,i.kt)("strong",{parentName:"h4"},"\u7efc\u5408\u80fd\u529b")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u4f60\u7684\u9879\u76ee\u89e3\u51b3\u4e86\u54ea\u4e9b\u5176\u4ed6\u540c\u7c7b\u9879\u76ee\u6ca1\u6709\u89e3\u51b3\u7684\u95ee\u9898\uff1f"),(0,i.kt)("li",{parentName:"ul"},"\u8bf4\u4e00\u4e0b\u524d\u7aef\u53d1\u9001\u8bf7\u6c42\u540e\uff0c\u670d\u52a1\u5668\u5904\u7406\u7684\u8fc7\u7a0b\uff0c\u4e2d\u95f4\u6d89\u53ca\u54ea\u4e9b\u534f\u8bae\uff1f")),(0,i.kt)("h4",{id:"\u5927\u6587\u4ef6\u4f20\u8f93"},(0,i.kt)("strong",{parentName:"h4"},"\u5927\u6587\u4ef6\u4f20\u8f93")),(0,i.kt)("p",null,"\u5148\u770b\u4e0b\u4e4b\u524d\u7684\u5927\u6587\u4ef6\u4f20\u8f93\uff0c\u4e5f\u5c31\u662f\u6e38\u53cc\u4e66\u4e0a\u7684\u4ee3\u7801\uff0c\u53d1\u9001\u6570\u636e\u53ea\u8c03\u7528\u4e86writev\u51fd\u6570\uff0c\u5e76\u5bf9\u5176\u8fd4\u56de\u503c\u662f\u5426\u5f02\u5e38\u505a\u4e86\u5904\u7406\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"}," 1bool http_conn::write()\n 2{\n 3    int temp=0;\n 4    int bytes_have_send=0;\n 5    int bytes_to_send=m_write_idx;\n 6    if(bytes_to_send==0)\n 7    {\n 8        modfd(m_epollfd,m_sockfd,EPOLLIN);\n 9        init();\n10        return true;\n11    }\n12    while(1)\n13    {\n14        temp=writev(m_sockfd,m_iv,m_iv_count);\n15        if(temp<=-1)\n16        {\n17            if(errno==EAGAIN)\n18            {\n19                modfd(m_epollfd,m_sockfd,EPOLLOUT);\n20                return true;\n21            }\n22            unmap();\n23            return false;\n24        }\n25        bytes_to_send-=temp;\n26        bytes_have_send+=temp;\n27        if(bytes_to_send<=bytes_have_send)\n28        {\n29            unmap();\n30            if(m_linger)\n31            {\n32                init();\n33                modfd(m_epollfd,m_sockfd,EPOLLIN);\n34                return true;\n35            }\n36            else\n37            {\n38                modfd(m_epollfd,m_sockfd,EPOLLIN);\n39                return false;\n40            }\n41        }\n42    }\n43}\n")),(0,i.kt)("p",null,"\u5728\u5b9e\u9645\u6d4b\u8bd5\u4e2d\u53d1\u73b0\uff0c\u5f53\u8bf7\u6c42\u5c0f\u6587\u4ef6\uff0c\u4e5f\u5c31\u662f\u8c03\u7528\u4e00\u6b21writev\u51fd\u6570\u5c31\u53ef\u4ee5\u5c06\u6570\u636e\u5168\u90e8\u53d1\u9001\u51fa\u53bb\u7684\u65f6\u5019\uff0c\u4e0d\u4f1a\u62a5\u9519\uff0c\u6b64\u65f6\u4e0d\u4f1a\u518d\u6b21\u8fdb\u5165while\u5faa\u73af\u3002"),(0,i.kt)("p",null,"\u4e00\u65e6\u8bf7\u6c42\u670d\u52a1\u5668\u6587\u4ef6\u8f83\u5927\u6587\u4ef6\u65f6\uff0c\u9700\u8981\u591a\u6b21\u8c03\u7528writev\u51fd\u6570\uff0c\u4fbf\u4f1a\u51fa\u73b0\u95ee\u9898\uff0c\u4e0d\u662f\u6587\u4ef6\u663e\u793a\u4e0d\u5168\uff0c\u5c31\u662f\u65e0\u6cd5\u663e\u793a\u3002"),(0,i.kt)("p",null,"\u5bf9\u6570\u636e\u4f20\u8f93\u8fc7\u7a0b\u5206\u6790\u540e\uff0c\u5b9a\u4f4d\u5230writev\u7684m_iv\u7ed3\u6784\u4f53\u6210\u5458\u6709\u95ee\u9898\uff0c\u6bcf\u6b21\u4f20\u8f93\u540e\u4e0d\u4f1a\u81ea\u52a8\u504f\u79fb\u6587\u4ef6\u6307\u9488\u548c\u4f20\u8f93\u957f\u5ea6\uff0c\u8fd8\u4f1a\u6309\u7167\u539f\u6709\u6307\u9488\u548c\u539f\u6709\u957f\u5ea6\u53d1\u9001\u6570\u636e\u3002"),(0,i.kt)("p",null,"\u6839\u636e\u524d\u9762\u7684\u57fa\u7840API\u5206\u6790\uff0c\u6211\u4eec\u77e5\u9053writev\u4ee5\u987a\u5e8fiov","[0]","\uff0ciov","[1]","\u81f3iov","[iovcnt-1]","\u4ece\u7f13\u51b2\u533a\u4e2d\u805a\u96c6\u8f93\u51fa\u6570\u636e\u3002\u9879\u76ee\u4e2d\uff0c\u7533\u8bf7\u4e862\u4e2aiov\uff0c\u5176\u4e2diov","[0]","\u4e3a\u5b58\u50a8\u62a5\u6587\u72b6\u6001\u884c\u7684\u7f13\u51b2\u533a\uff0ciov","[1]","\u6307\u5411\u8d44\u6e90\u6587\u4ef6\u6307\u9488\u3002"),(0,i.kt)("p",null,"\u5bf9\u4e0a\u8ff0\u4ee3\u7801\u505a\u4e86\u4fee\u6539\u5982\u4e0b\uff1a"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"\u7531\u4e8e\u62a5\u6587\u6d88\u606f\u62a5\u5934\u8f83\u5c0f\uff0c\u7b2c\u4e00\u6b21\u4f20\u8f93\u540e\uff0c\u9700\u8981\u66f4\u65b0m_iv","[1]",".iov_base\u548ciov_len\uff0cm_iv","[0]",".iov_len\u7f6e\u62100\uff0c\u53ea\u4f20\u8f93\u6587\u4ef6\uff0c\u4e0d\u7528\u4f20\u8f93\u54cd\u5e94\u6d88\u606f\u5934"),(0,i.kt)("li",{parentName:"ul"},"\u6bcf\u6b21\u4f20\u8f93\u540e\u90fd\u8981\u66f4\u65b0\u4e0b\u6b21\u4f20\u8f93\u7684\u6587\u4ef6\u8d77\u59cb\u4f4d\u7f6e\u548c\u957f\u5ea6")),(0,i.kt)("p",null,"\u66f4\u65b0\u540e\uff0c\u5927\u6587\u4ef6\u4f20\u8f93\u5f97\u5230\u4e86\u89e3\u51b3\u3002"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-cpp"}," 1bool http_conn::write()\n 2{\n 3    int temp = 0;\n 4\n 5    int newadd = 0;\n 6\n 7    if (bytes_to_send == 0)\n 8    {\n 9        modfd(m_epollfd, m_sockfd, EPOLLIN, m_TRIGMode);\n10        init();\n11        return true;\n12    }\n13\n14    while (1)\n15    {\n16        temp = writev(m_sockfd, m_iv, m_iv_count);\n17\n18        if (temp >= 0)\n19        {\n20            bytes_have_send += temp;\n21            newadd = bytes_have_send - m_write_idx;\n22        }\n23        else\n24        {\n25            if (errno == EAGAIN)\n26            {\n27                if (bytes_have_send >= m_iv[0].iov_len)\n28                {\n29                    m_iv[0].iov_len = 0;\n30                    m_iv[1].iov_base = m_file_address + newadd;\n31                    m_iv[1].iov_len = bytes_to_send;\n32                }\n33                else\n34                {\n35                    m_iv[0].iov_base = m_write_buf + bytes_have_send;\n36                    m_iv[0].iov_len = m_iv[0].iov_len - bytes_have_send;\n37                }\n38                modfd(m_epollfd, m_sockfd, EPOLLOUT, m_TRIGMode);\n39                return true;\n40            }\n41            unmap();\n42            return false;\n43        }\n44        bytes_to_send -= temp;\n45        if (bytes_to_send <= 0)\n46\n47        {\n48            unmap();\n49            modfd(m_epollfd, m_sockfd, EPOLLIN, m_TRIGMode);\n50\n51            if (m_linger)\n52            {\n53                init();\n54                return true;\n55            }\n56            else\n57            {\n58                return false;\n59            }\n60        }\n61    }\n62}\n")))}s.isMDXComponent=!0}}]);