(self.webpackChunkwiki=self.webpackChunkwiki||[]).push([[1257],{3905:function(e,n,t){"use strict";t.d(n,{Zo:function(){return a},kt:function(){return g}});var r=t(67294);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function l(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?l(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):l(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function u(e,n){if(null==e)return{};var t,r,i=function(e,n){if(null==e)return{};var t,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||(i[t]=e[t]);return i}(e,n);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)t=l[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(i[t]=e[t])}return i}var s=r.createContext({}),d=function(e){var n=r.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},a=function(e){var n=d(e.components);return r.createElement(s.Provider,{value:n},e.children)},p={inlineCode:"code",wrapper:function(e){var n=e.children;return r.createElement(r.Fragment,{},n)}},c=r.forwardRef((function(e,n){var t=e.components,i=e.mdxType,l=e.originalType,s=e.parentName,a=u(e,["components","mdxType","originalType","parentName"]),c=d(t),g=i,m=c["".concat(s,".").concat(g)]||c[g]||p[g]||l;return t?r.createElement(m,o(o({ref:n},a),{},{components:t})):r.createElement(m,o({ref:n},a))}));function g(e,n){var t=arguments,i=n&&n.mdxType;if("string"==typeof e||i){var l=t.length,o=new Array(l);o[0]=c;var u={};for(var s in n)hasOwnProperty.call(n,s)&&(u[s]=n[s]);u.originalType=e,u.mdxType="string"==typeof e?e:i,o[1]=u;for(var d=2;d<l;d++)o[d]=t[d];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}c.displayName="MDXCreateElement"},478:function(e,n,t){"use strict";t.r(n),t.d(n,{frontMatter:function(){return u},metadata:function(){return s},toc:function(){return d},default:function(){return p}});var r=t(22122),i=t(19756),l=(t(67294),t(3905)),o=["components"],u={id:"C3.\u7a0b\u5e8f\u89c4\u8303",title:"C3.\u7a0b\u5e8f\u89c4\u8303","typora-root-url":"../"},s={unversionedId:"Server/C3.\u7a0b\u5e8f\u89c4\u8303",id:"Server/C3.\u7a0b\u5e8f\u89c4\u8303",isDocsHomePage:!1,title:"C3.\u7a0b\u5e8f\u89c4\u8303",description:"Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u89c4\u8303",source:"@site/docs/7.Server/C3.\u7a0b\u5e8f\u89c4\u8303.md",sourceDirName:"7.Server",slug:"/Server/C3.\u7a0b\u5e8f\u89c4\u8303",permalink:"/Server/C3.\u7a0b\u5e8f\u89c4\u8303",editUrl:"https://github.com/worst0/wiki_note/edit/main/docs/7.Server/C3.\u7a0b\u5e8f\u89c4\u8303.md",version:"current",frontMatter:{id:"C3.\u7a0b\u5e8f\u89c4\u8303",title:"C3.\u7a0b\u5e8f\u89c4\u8303","typora-root-url":"../"},sidebar:"Document\ud83d\udcbb",previous:{title:"C2.\u9ad8\u7ea7IO\u51fd\u6570",permalink:"/Server/C2.\u9ad8\u7ea7IO\u51fd\u6570"},next:{title:"C4.IO\u590d\u7528",permalink:"/Server/C4.IO\u590d\u7528"}},d=[{value:"Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u89c4\u8303",id:"linux\u670d\u52a1\u5668\u7a0b\u5e8f\u89c4\u8303",children:[{value:"\u65e5\u5fd7",id:"\u65e5\u5fd7",children:[]},{value:"\u7528\u6237\u4fe1\u606f",id:"\u7528\u6237\u4fe1\u606f",children:[]},{value:"\u8fdb\u7a0b\u95f4\u5173\u7cfb",id:"\u8fdb\u7a0b\u95f4\u5173\u7cfb",children:[]},{value:"\u7cfb\u7edf\u8d44\u6e90\u9650\u5236",id:"\u7cfb\u7edf\u8d44\u6e90\u9650\u5236",children:[]},{value:"\u670d\u52a1\u5668\u7a0b\u5e8f\u540e\u53f0\u5316",id:"\u670d\u52a1\u5668\u7a0b\u5e8f\u540e\u53f0\u5316",children:[]}]}],a={toc:d};function p(e){var n=e.components,u=(0,i.Z)(e,o);return(0,l.kt)("wrapper",(0,r.Z)({},a,u,{components:n,mdxType:"MDXLayout"}),(0,l.kt)("h2",{id:"linux\u670d\u52a1\u5668\u7a0b\u5e8f\u89c4\u8303"},"Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u89c4\u8303"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u4e00\u822c\u4ee5\u540e\u53f0\u8fdb\u7a0b\u5f62\u5f0f\u8fd0\u884c\u3002\u540e\u53f0\u8fdb\u7a0b\u53c8\u79f0\u5b88\u62a4\u8fdb\u7a0b\uff08daemon\uff09\u3002\u5b83\u6ca1\u6709\u63a7\u5236\u7ec8\u7aef\uff0c\u56e0\u800c\u4e5f\u4e0d\u4f1a\u610f\u5916\u63a5\u6536\u5230\u7528\u6237\u8f93\u5165\u3002\u5b88\u62a4\u8fdb\u7a0b\u7684\u7236\u8fdb\u7a0b\u901a\u5e38\u662finit\u8fdb\u7a0b\uff08PID\u4e3a1\u7684\u8fdb\u7a0b\uff09\u3002"),(0,l.kt)("li",{parentName:"ul"},"Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u901a\u5e38\u6709\u4e00\u5957\u65e5\u5fd7\u7cfb\u7edf\uff0c\u5b83\u81f3\u5c11\u80fd\u8f93\u51fa\u65e5\u5fd7\u5230\u6587\u4ef6\uff0c\u6709\u7684\u9ad8\u7ea7\u670d\u52a1\u5668\u8fd8\u80fd\u8f93\u51fa\u65e5\u5fd7\u5230\u4e13\u95e8\u7684UDP\u670d\u52a1\u5668\u3002\u5927\u90e8\u5206\u540e\u53f0\u8fdb\u7a0b\u90fd\u5728/var/log\u76ee\u5f55\u4e0b\u62e5\u6709\u81ea\u5df1\u7684\u65e5\u5fd7\u76ee\u5f55\u3002"),(0,l.kt)("li",{parentName:"ul"},"Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u4e00\u822c\u4ee5\u67d0\u4e2a\u4e13\u95e8\u7684\u975eroot\u8eab\u4efd\u8fd0\u884c\u3002\u6bd4\u5982mysqld\u3001httpd\u3001syslogd\u7b49\u540e\u53f0\u8fdb\u7a0b\uff0c\u5206\u522b\u62e5\u6709\u81ea\u5df1\u7684\u8fd0\u884c\u8d26\u6237mysql\u3001apache\u548csyslog\u3002"),(0,l.kt)("li",{parentName:"ul"},"inux\u670d\u52a1\u5668\u7a0b\u5e8f\u901a\u5e38\u662f\u53ef\u914d\u7f6e\u7684\u3002\u670d\u52a1\u5668\u7a0b\u5e8f\u901a\u5e38\u80fd\u5904\u7406\u5f88\u591a\u547d\u4ee4\u884c\u9009\u9879\uff0c\u5982\u679c\u4e00\u6b21\u8fd0\u884c\u7684\u9009\u9879\u592a\u591a\uff0c\u5219\u53ef\u4ee5\u7528\u914d\u7f6e\u6587\u4ef6\u6765\u7ba1\u7406\u3002\u7edd\u5927\u591a\u6570\u670d\u52a1\u5668\u7a0b\u5e8f\u90fd\u6709\u914d\u7f6e\u6587\u4ef6\uff0c\u5e76\u5b58\u653e\u5728/etc\u76ee\u5f55\u4e0b\u3002"),(0,l.kt)("li",{parentName:"ul"},"Linux\u670d\u52a1\u5668\u8fdb\u7a0b\u901a\u5e38\u4f1a\u5728\u542f\u52a8\u7684\u65f6\u5019\u751f\u6210\u4e00\u4e2aPID\u6587\u4ef6\u5e76\u5b58\u5165/var/run\u76ee\u5f55\u4e2d\uff0c\u4ee5\u8bb0\u5f55\u8be5\u540e\u53f0\u8fdb\u7a0b\u7684PID\u3002\u6bd4\u5982syslogd\u7684PID\u6587\u4ef6\u662f/var/run/syslogd.pid\u3002"),(0,l.kt)("li",{parentName:"ul"},"Linux\u670d\u52a1\u5668\u7a0b\u5e8f\u901a\u5e38\u9700\u8981\u8003\u8651\u7cfb\u7edf\u8d44\u6e90\u548c\u9650\u5236\uff0c\u4ee5\u9884\u6d4b\u81ea\u8eab\u80fd\u627f\u53d7\u591a\u5927\u8d1f\u8377\uff0c\u6bd4\u5982\u8fdb\u7a0b\u53ef\u7528\u6587\u4ef6\u63cf\u8ff0\u7b26\u603b\u6570\u548c\u5185\u5b58\u603b\u91cf\u7b49\u3002")),(0,l.kt)("h3",{id:"\u65e5\u5fd7"},"\u65e5\u5fd7"),(0,l.kt)("p",null,"Linux\u63d0\u4f9b\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0b\u6765\u5904\u7406\u7cfb\u7edf\u65e5\u5fd7\u2014\u2014syslogd\uff0c\u4e0d\u8fc7\u73b0\u5728\u7684Linux\u7cfb\u7edf\u4e0a\u4f7f\u7528\u7684\u90fd\u662f\u5b83\u7684\u5347\u7ea7\u7248\u2014\u2014rsyslogd\u3002"),(0,l.kt)("p",null,"rsyslogd\u5b88\u62a4\u8fdb\u7a0b\u65e2\u80fd\u63a5\u6536\u7528\u6237\u8fdb\u7a0b\u8f93\u51fa\u7684\u65e5\u5fd7\uff0c\u53c8\u80fd\u63a5\u6536\u5185\u6838\u65e5\u5fd7\u3002\u7528\u6237\u8fdb\u7a0b\u662f\u901a\u8fc7\u8c03\u7528syslog\u51fd\u6570\u751f\u6210\u7cfb\u7edf\u65e5\u5fd7\u7684\u3002\u8be5\u51fd\u6570\u5c06\u65e5\u5fd7\u8f93\u51fa\u5230\u4e00\u4e2aUNIX\u672c\u5730\u57dfsocket\u7c7b\u578b\uff08AF_UNIX\uff09\u7684\u6587\u4ef6/dev/log\u4e2d\uff0crsyslogd\u5219\u76d1\u542c\u8be5\u6587\u4ef6\u4ee5\u83b7\u53d6\u7528\u6237\u8fdb\u7a0b\u7684\u8f93\u51fa\u3002\u5185\u6838\u65e5\u5fd7\u5728\u8001\u7684\u7cfb\u7edf\u4e0a\u662f\u901a\u8fc7\u53e6\u5916\u4e00\u4e2a\u5b88\u62a4\u8fdb\u7a0brklogd\u6765\u7ba1\u7406\u7684\uff0crsyslogd\u5229\u7528\u989d\u5916\u7684\u6a21\u5757\u5b9e\u73b0\u4e86\u76f8\u540c\u7684\u529f\u80fd\u3002\u5185\u6838\u65e5\u5fd7\u7531printk\u7b49\u51fd\u6570\u6253\u5370\u81f3\u5185\u6838\u7684\u73af\u72b6\u7f13\u5b58\uff08ring buffer\uff09\u4e2d\u3002\u73af\u72b6\u7f13\u5b58\u7684\u5185\u5bb9\u76f4\u63a5\u6620\u5c04\u5230/proc/kmsg\u6587\u4ef6\u4e2d\u3002rsyslogd\u5219\u901a\u8fc7\u8bfb\u53d6\u8be5\u6587\u4ef6\u83b7\u5f97\u5185\u6838\u65e5\u5fd7\u3002"),(0,l.kt)("p",null,"rsyslogd\u5b88\u62a4\u8fdb\u7a0b\u5728\u63a5\u6536\u5230\u7528\u6237\u8fdb\u7a0b\u6216\u5185\u6838\u8f93\u5165\u7684\u65e5\u5fd7\u540e\uff0c\u4f1a\u628a\u5b83\u4eec\u8f93\u51fa\u81f3\u67d0\u4e9b\u7279\u5b9a\u7684\u65e5\u5fd7\u6587\u4ef6\u3002\u9ed8\u8ba4\u60c5\u51b5\u4e0b\uff0c\u8c03\u8bd5\u4fe1\u606f\u4f1a\u4fdd\u5b58\u81f3/var/log/debug\u6587\u4ef6\uff0c\u666e\u901a\u4fe1\u606f\u4fdd\u5b58\u81f3/var/log/messages\u6587\u4ef6\uff0c\u5185\u6838\u6d88\u606f\u5219\u4fdd\u5b58\u81f3/var/log/kern.log\u6587\u4ef6\u3002\u4e0d\u8fc7\uff0c\u65e5\u5fd7\u4fe1\u606f\u5177\u4f53\u5982\u4f55\u5206\u53d1\uff0c\u53ef\u4ee5\u5728rsyslogd\u7684\u914d\u7f6e\u6587\u4ef6\u4e2d\u8bbe\u7f6e\u3002rsyslogd\u7684\u4e3b\u914d\u7f6e\u6587\u4ef6\u662f/etc/rsyslog.conf\uff0c\u5176\u4e2d\u4e3b\u8981\u53ef\u4ee5\u8bbe\u7f6e\u7684\u9879\u5305\u62ec\uff1a\u5185\u6838\u65e5\u5fd7\u8f93\u5165\u8def\u5f84\uff0c\u662f\u5426\u63a5\u6536UDP\u65e5\u5fd7\u53ca\u5176\u76d1\u542c\u7aef\u53e3\uff08\u9ed8\u8ba4\u662f514\uff0c\u89c1/etc/services\u6587\u4ef6\uff09\uff0c\u662f\u5426\u63a5\u6536TCP\u65e5\u5fd7\u53ca\u5176\u76d1\u542c\u7aef\u53e3\uff0c\u65e5\u5fd7\u6587\u4ef6\u7684\u6743\u9650\uff0c\u5305\u542b\u54ea\u4e9b\u5b50\u914d\u7f6e\u6587\u4ef6\uff08\u6bd4\u5982/etc/rsyslog.d/*.conf\uff09\u3002rsyslogd\u7684\u5b50\u914d\u7f6e\u6587\u4ef6\u5219\u6307\u5b9a\u5404\u7c7b\u65e5\u5fd7\u7684\u76ee\u6807\u5b58\u50a8\u6587\u4ef6\u3002"),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20210909111312035",src:t(52232).Z})),(0,l.kt)("h3",{id:"\u7528\u6237\u4fe1\u606f"},"\u7528\u6237\u4fe1\u606f"),(0,l.kt)("h4",{id:"uid\u3001euid\u3001gid\u548cegid"},"UID\u3001EUID\u3001GID\u548cEGID"),(0,l.kt)("p",null,"\u83b7\u53d6\u548c\u8bbe\u7f6e\u5f53\u524d\u8fdb\u7a0b\u7684\u771f\u5b9e\u7528\u6237ID\uff08UID\uff09\u3001\u6709\u6548\u7528\u6237ID\uff08EUID\uff09\u3001\u771f\u5b9e\u7ec4ID\uff08GID\uff09\u548c\u6709\u6548\u7ec4ID\uff08EGID\uff09\uff1a"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include<sys/types.h>\n#include<unistd.h>\nuid_t getuid();/*\u83b7\u53d6\u771f\u5b9e\u7528\u6237ID*/\nuid_t geteuid();/*\u83b7\u53d6\u6709\u6548\u7528\u6237ID*/\ngid_t getgid();/*\u83b7\u53d6\u771f\u5b9e\u7ec4ID*/\ngid_t getegid();/*\u83b7\u53d6\u6709\u6548\u7ec4ID*/\nint setuid(uid_t uid);/*\u8bbe\u7f6e\u771f\u5b9e\u7528\u6237ID*/\nint seteuid(uid_t uid);/*\u8bbe\u7f6e\u6709\u6548\u7528\u6237ID*/\nint setgid(gid_t gid);/*\u8bbe\u7f6e\u771f\u5b9e\u7ec4ID*/\nint setegid(gid_t gid);/*\u8bbe\u7f6e\u6709\u6548\u7ec4ID*/\n")),(0,l.kt)("h3",{id:"\u8fdb\u7a0b\u95f4\u5173\u7cfb"},"\u8fdb\u7a0b\u95f4\u5173\u7cfb"),(0,l.kt)("p",null,"Linux\u4e0b\u6bcf\u4e2a\u8fdb\u7a0b\u90fd\u96b6\u5c5e\u4e8e\u4e00\u4e2a\u8fdb\u7a0b\u7ec4\uff0c\u56e0\u6b64\u5b83\u4eec\u9664\u4e86PID\u4fe1\u606f\u5916\uff0c\u8fd8\u6709\u8fdb\u7a0b\u7ec4ID\uff08PGID\uff09\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include<unistd.h>\npid_t getpgid(pid_t pid);\n")),(0,l.kt)("p",null,"\u8be5\u51fd\u6570\u6210\u529f\u65f6\u8fd4\u56de\u8fdb\u7a0bpid\u6240\u5c5e\u8fdb\u7a0b\u7ec4\u7684PGID\uff0c\u5931\u8d25\u5219\u8fd4\u56de-1\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("p",null,"\u6bcf\u4e2a\u8fdb\u7a0b\u7ec4\u90fd\u6709\u4e00\u4e2a\u9996\u9886\u8fdb\u7a0b\uff0c\u5176PGID\u548cPID\u76f8\u540c\u3002\u8fdb\u7a0b\u7ec4\u5c06\u4e00\u76f4\u5b58\u5728\uff0c\u76f4\u5230\u5176\u4e2d\u6240\u6709\u8fdb\u7a0b\u90fd\u9000\u51fa\uff0c\u6216\u8005\u52a0\u5165\u5230\u5176\u4ed6\u8fdb\u7a0b\u7ec4\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include<unistd.h>\nint setpgid(pid_t pid,pid_t pgid);\n")),(0,l.kt)("p",null,"\u8be5\u51fd\u6570\u5c06PID\u4e3apid\u7684\u8fdb\u7a0b\u7684PGID\u8bbe\u7f6e\u4e3apgid\u3002\u5982\u679cpid\u548cpgid\u76f8\u540c\uff0c\u5219\u7531pid\u6307\u5b9a\u7684\u8fdb\u7a0b\u5c06\u88ab\u8bbe\u7f6e\u4e3a\u8fdb\u7a0b\u7ec4\u9996\u9886\uff1b\u5982\u679cpid\u4e3a0\uff0c\u5219\u8868\u793a\u8bbe\u7f6e\u5f53\u524d\u8fdb\u7a0b\u7684PGID\u4e3apgid\uff1b\u5982\u679cpgid\u4e3a0\uff0c\u5219\u4f7f\u7528pid\u4f5c\u4e3a\u76ee\u6807PGID\u3002setpgid\u51fd\u6570\u6210\u529f\u65f6\u8fd4\u56de0\uff0c\u5931\u8d25\u5219\u8fd4\u56de-1\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("p",null,"\u4e00\u4e2a\u8fdb\u7a0b\u53ea\u80fd\u8bbe\u7f6e\u81ea\u5df1\u6216\u8005\u5176\u5b50\u8fdb\u7a0b\u7684PGID\u3002\u5e76\u4e14\uff0c\u5f53\u5b50\u8fdb\u7a0b\u8c03\u7528exec\u7cfb\u5217\u51fd\u6570\u540e\uff0c\u6211\u4eec\u4e5f\u4e0d\u80fd\u518d\u5728\u7236\u8fdb\u7a0b\u4e2d\u5bf9\u5b83\u8bbe\u7f6ePGID\u3002"),(0,l.kt)("h4",{id:"\u4f1a\u8bdd"},"\u4f1a\u8bdd"),(0,l.kt)("p",null,"\u4e00\u4e9b\u6709\u5173\u8054\u7684\u8fdb\u7a0b\u7ec4\u5c06\u5f62\u6210\u4e00\u4e2a\u4f1a\u8bdd\uff08session\uff09"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include<unistd.h>\npid_t setsid(void);\npid_t getsid(pid_t pid);\n")),(0,l.kt)("h4",{id:"\u7528ps\u547d\u4ee4\u67e5\u770b\u8fdb\u7a0b\u5173\u7cfb"},"\u7528ps\u547d\u4ee4\u67e5\u770b\u8fdb\u7a0b\u5173\u7cfb"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-shell"}," $ps-o pid,ppid,pgid,sid,comm|less\n PID    PPID    PGID     SID COMMAND\n 142064    2807  142064  142064 zsh\n 146944  142064  146944  142064 vim\n 156690  142064  156690  142064 ps\n 156691  142064  156690  142064 less\n(END)\n")),(0,l.kt)("p",null,(0,l.kt)("img",{alt:"image-20210909111721506",src:t(18326).Z})),(0,l.kt)("h3",{id:"\u7cfb\u7edf\u8d44\u6e90\u9650\u5236"},"\u7cfb\u7edf\u8d44\u6e90\u9650\u5236"),(0,l.kt)("p",null,"Linux\u4e0a\u8fd0\u884c\u7684\u7a0b\u5e8f\u90fd\u4f1a\u53d7\u5230\u8d44\u6e90\u9650\u5236\u7684\u5f71\u54cd\uff0c\u6bd4\u5982\u7269\u7406\u8bbe\u5907\u9650\u5236\uff08CPU\u6570\u91cf\u3001\u5185\u5b58\u6570\u91cf\u7b49\uff09\u3001\u7cfb\u7edf\u7b56\u7565\u9650\u5236\uff08CPU\u65f6\u95f4\u7b49\uff09\uff0c\u4ee5\u53ca\u5177\u4f53\u5b9e\u73b0\u7684\u9650\u5236\uff08\u6bd4\u5982\u6587\u4ef6\u540d\u7684\u6700\u5927\u957f\u5ea6\uff09\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include<sys/resource.h>\nint getrlimit(int resource,struct rlimit*rlim);\nint setrlimit(int resource,const struct rlimit*rlim);\n\nstruct rlimit\n{\nrlim_t rlim_cur;\nrlim_t rlim_max;\n};\n")),(0,l.kt)("h3",{id:"\u670d\u52a1\u5668\u7a0b\u5e8f\u540e\u53f0\u5316"},"\u670d\u52a1\u5668\u7a0b\u5e8f\u540e\u53f0\u5316"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},"#include<unistd.h>\nint daemon(int nochdir,int noclose);\n")),(0,l.kt)("p",null,"nochdir\u53c2\u6570\u7528\u4e8e\u6307\u5b9a\u662f\u5426\u6539\u53d8\u5de5\u4f5c\u76ee\u5f55\uff0c\u5982\u679c\u7ed9\u5b83\u4f20\u90120\uff0c\u5219\u5de5\u4f5c\u76ee\u5f55\u5c06\u88ab\u8bbe\u7f6e\u4e3a\u201c/\u201d\uff08\u6839\u76ee\u5f55\uff09\uff0c\u5426\u5219\u7ee7\u7eed\u4f7f\u7528\u5f53\u524d\u5de5\u4f5c\u76ee\u5f55\u3002noclose\u53c2\u6570\u4e3a0\u65f6\uff0c\u6807\u51c6\u8f93\u5165\u3001\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u90fd\u88ab\u91cd\u5b9a\u5411\u5230/dev/null\u6587\u4ef6\uff0c\u5426\u5219\u4f9d\u7136\u4f7f\u7528\u539f\u6765\u7684\u8bbe\u5907\u3002"),(0,l.kt)("p",null,"\u8be5\u51fd\u6570\u6210\u529f\u65f6\u8fd4\u56de0\uff0c\u5931\u8d25\u5219\u8fd4\u56de-1\u5e76\u8bbe\u7f6eerrno\u3002"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-cpp"},'bool dameonize() {\n    pid_t pid = fork():\n    if (pid < 0) {\n        return false;\n    } else if (pid > 0) {\n        exit(0);\n    }\n    /*\u8bbe\u7f6e\u6587\u4ef6\u6743\u9650\u63a9\u7801\u3002\u5f53\u8fdb\u7a0b\u521b\u5efa\u65b0\u6587\u4ef6\uff08\u4f7f\u7528open(const char*pathname,int flags,mode_t mode)\u7cfb\u7edf\u8c03\u7528\uff09\u65f6\uff0c\u6587\u4ef6\u7684\u6743\u9650\u5c06\u662fmode\uff060777*/\n    unmask(0);\n    /*\u521b\u5efa\u65b0\u7684\u4f1a\u8bdd\uff0c\u8bbe\u7f6e\u672c\u8fdb\u7a0b\u4e3a\u8fdb\u7a0b\u7ec4\u7684\u9996\u9886*/\n    pid_t sid = setsid();\n    if (sid < 0) {\n        return false;\n    }\n    if ((chdir("/")) < 0) {\n        return false;\n    }\n    /*\u5173\u95ed\u6807\u51c6\u8f93\u5165\u8bbe\u5907\u3001\u6807\u51c6\u8f93\u51fa\u8bbe\u5907\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u8bbe\u5907*/\n    close(STDIN_FILENO);\n    close(STDOUT_FILENO);\n    close(sTDERR_FILENO);\n/*\u5173\u95ed\u5176\u4ed6\u5df2\u7ecf\u6253\u5f00\u7684\u6587\u4ef6\u63cf\u8ff0\u7b26\uff0c\u4ee3\u7801\u7701\u7565*/\n\n/*\u5c06\u6807\u51c6\u8f93\u5165\u3001\u6807\u51c6\u8f93\u51fa\u548c\u6807\u51c6\u9519\u8bef\u8f93\u51fa\u90fd\u5b9a\u5411\u5230/dev/null\u6587\u4ef6*/\n    open("/dev/null", O_EDONLY);\n    open("/dev/null", O_RDWR);\n    open("/dev/null", O_ERWR);\n    return true;\n}\n\n')))}p.isMDXComponent=!0},52232:function(e,n,t){"use strict";n.Z=t.p+"assets/images/image-20210909111312035-1633593998948-d68aeddcfc22bb2eb31207626c243d2e.png"},18326:function(e,n,t){"use strict";n.Z=t.p+"assets/images/image-20210909111721506-1633594001562-e5a33b88017eed313f6589d4333b198f.png"}}]);